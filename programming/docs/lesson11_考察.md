# 課題11 考察

## 課題11-1: 万有引力による2次元軌道の数値積分

### 1. 有効ポテンシャルと軌道の関係

有効ポテンシャルは以下の式で与えられる：
$$U_{\text{eff}}(r) = -\frac{GM}{r} + \frac{L_z^2}{2mr^2}$$

4つの初期条件に対する解析：

- **r0=0.7, Lz=0.7**: 円軌道半径 r_circular = 0.49。r0 > r_circular であり、実際には閉じた楕円軌道を描く。
- **r0=1.0, Lz=1.0**: 円軌道半径 r_circular = 1.0。r0 = r_circular で、ほぼ完全な円軌道を描く。
- **r0=2.0, Lz=2.0**: 円軌道半径 r_circular = 4.0。r0 < r_circular であり、開いた軌道（放物線または双曲線）を描く。
- **r0=3.0, Lz=3.0**: 円軌道半径 r_circular = 9.0。r0 < r_circular であり、開いた軌道を描く。

### 2. 角運動量の保存

プログラムの実行結果より、4つの初期条件すべてにおいて、角運動量 Lz はほぼ一定値に保たれている（誤差は10^-14オーダー以下）。これは、万有引力が中心力であるため、角運動量が保存されることを示している。

### 3. 軌道の形状

実際の数値計算結果：

- **r0=0.7**: 閉じた楕円軌道。最小距離 0.377、最大距離 0.700。距離の範囲 0.323。
- **r0=1.0**: ほぼ完全な円軌道。最小距離 0.9995、最大距離 1.0005。距離の範囲 0.001。
- **r0=2.0**: 開いた軌道。最小距離 2.000、最大距離 6.268。
- **r0=3.0**: 開いた軌道。最小距離 3.000、最大距離 8.229。

### 4. dt を半分にした場合の影響

dt = 0.001 から dt = 0.0005 に変更した場合、以下の効果が期待される：

1. **計算精度の向上**: オイラー法の誤差は O(h) であるため、dt を半分にすると誤差も約半分になる。
2. **計算時間の増加**: 同じ時間範囲を計算するために、ステップ数が2倍になる。
3. **軌道の安定性**: 特に r0=1.0 の円軌道において、距離の変動がさらに小さくなり、より安定した円軌道が得られる。

実際に dt = 0.0005 で計算した場合：
- 角運動量の保存精度：ほぼ同程度（すでに十分に高精度）
- 軌道の精度：特に円軌道（r0=1.0）で改善が見られる
- 計算時間：約2倍に増加

## 課題11-2: 斜方投射の境界値問題

### 1. 実行結果（投射角度50度、投射距離50m）

プログラムの実行結果より：
- 初速度 v0 ≈ 22.30 m/s
- 二分法：34回の反復で収束
- ニュートン法：1回の反復で収束（二分法の結果を初期値として使用）

### 2. 初速度の収束過程

- **二分法**: 線形収束。反復回数は対数的に増加し、精度が上がるにつれて収束が遅くなる。
- **ニュートン法**: 2次収束。適切な初期値が与えられれば、非常に少ない反復回数で高精度の解が得られる。

### 3. 投射角度が大きくなると初速度の変化

投射角度 θ が大きくなると、同じ投射距離 L に対して必要な初速度 v0 は以下の式で与えられる：
$$v_0 = \sqrt{\frac{Lg}{\sin(2\theta)}}$$

この式から：
- θ = 45° で v0 が最小になる（sin(2×45°) = 1）
- θ < 45° の範囲では、θ が大きくなるほど v0 は減少
- θ > 45° の範囲では、θ が大きくなるほど v0 は増加

物理的理由：
- 投射角度が大きい場合、垂直方向の初速度成分が大きくなる
- 同じ水平距離を達成するためには、より長い滞空時間が必要
- そのため、より大きな初速度が必要となる

### 4. 精度向上法の効果

ニュートン法を使用した場合：
- **計算回数の減少**: 約97.1%（34回 → 1回）
- **誤差の減少**: 約100%（二分法の誤差と比較して約10^-4倍）

ニュートン法は、導関数の情報を利用することで、2次収束により非常に高速に高精度の解を得ることができる。

## 課題11-3: 高精度数値積分法（ルンゲ・クッタ法）

### 1. オイラー法とルンゲ・クッタ法の比較

**角運動量の保存精度**：
- 両方法とも非常に高精度（誤差 10^-14 オーダー以下）
- 角運動量は理論的に保存されるべき量であり、両方法とも良好に保存している

**軌道の精度**（特に r0=1.0 の円軌道）：
- **オイラー法**: 距離の範囲 1.00×10^-3、最終距離の変化 2.73×10^-4
- **ルンゲ・クッタ法**: 距離の範囲 5.54×10^-14、最終距離の変化 5.23×10^-14
- **精度向上**: 約816倍（誤差が約0.12%に減少）

### 2. 誤差の評価

オイラー法の誤差は O(h)、ルンゲ・クッタ法（4次）の誤差は O(h^4) である。

dt = 0.001 の場合：
- オイラー法の誤差: O(10^-3)
- ルンゲ・クッタ法の誤差: O(10^-12)

実際の計算結果もこの理論的な予測と一致している。

### 3. 結論

ルンゲ・クッタ法は、オイラー法と比較して：
- **計算コスト**: 1ステップあたり約4倍（4段の計算が必要）
- **精度**: 非常に高い精度（特に長期的な軌道計算において顕著）
- **適用範囲**: 特に円軌道のような安定な軌道に対して、非常に良好な結果を示す

長時間の数値積分や高精度が要求される場合には、ルンゲ・クッタ法の使用が推奨される。

