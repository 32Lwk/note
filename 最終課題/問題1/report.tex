\documentclass[11pt,a4paper]{ltjsarticle}
\usepackage[no-math]{luatexja-fontspec}
\setmainjfont{Hiragino Mincho ProN}
\setsansjfont{Hiragino Kaku Gothic ProN}
\usepackage{amsmath,amssymb}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{url}
\usepackage{geometry}
\geometry{margin=2.5cm}
\usepackage{float}
\usepackage[draft=false]{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    citecolor=blue,
    urlcolor=blue,
    pdfusetitle=true
}

% コード表示の設定
\lstset{
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black},
    stringstyle=\color{red},
    numbers=left,
    numberstyle=\tiny\color{gray},
    stepnumber=1,
    numbersep=5pt,
    frame=single,
    breaklines=true,
    breakatwhitespace=true,
    tabsize=4,
    showspaces=false,
    showstringspaces=false
}

\lstdefinestyle{cstyle}{
    language=C,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black},
    stringstyle=\color{red},
    numbers=left,
    numberstyle=\tiny\color{gray},
    frame=single,
    breaklines=true,
    tabsize=4
}

\lstdefinestyle{pythonstyle}{
    language=Python,
    basicstyle=\ttfamily\small,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{green!60!black},
    stringstyle=\color{red},
    numbers=left,
    numberstyle=\tiny\color{gray},
    frame=single,
    breaklines=true,
    tabsize=4
}

\title{数値シミュレーションによる\\ブラウン運動の解析}
\author{名古屋大学　理学部物理学科2年\\川嶋宥翔\\学籍番号：062400506}
\date{2026年1月24日}

\begin{document}

\thispagestyle{empty}
\begin{center}
\vspace*{4cm}
{\fontsize{20pt}{24pt}\selectfont\mdseries 数値シミュレーションによるブラウン運動の解析\par}
\vspace{2.5cm}
{\fontsize{18pt}{22pt}\selectfont 名古屋大学　理学部物理学科2年\par}
\vspace{0.8cm}
{\fontsize{18pt}{22pt}\selectfont 川嶋宥翔\par}
\vspace{0.5cm}
{\fontsize{18pt}{22pt}\selectfont 学籍番号：062400506\par}
\vspace{2.5cm}
{\fontsize{16pt}{20pt}\selectfont 2026年1月24日\par}
\end{center}
\vfill
\newpage

\tableofcontents
\newpage

\section{はじめに}

本レポートでは、ランジュバン方程式を用いたブラウン運動の数値シミュレーションと解析を行う。Box-Muller法による正規分布乱数の生成から始め、2次元ブラウン運動の時間発展を計算し、平均二乗変位や拡散係数の理論値との比較を行う。さらに、温度、質量、摩擦係数などのパラメータ依存性を詳細に検証する。最後に、粒子の運動エネルギー分布関数を調べ、熱平衡状態における統計的性質を確認する。

\section{理論的背景}

\subsection{ランジュバン方程式}

ブラウン運動を記述するランジュバン方程式は以下のように表される：

\begin{equation}
m \frac{dv}{dt} = -\gamma v + \xi(t)
\label{eq:langevin_velocity}
\end{equation}

\begin{equation}
\frac{dr}{dt} = v
\label{eq:langevin_position}
\end{equation}

ここで、$m$は質量、$\gamma$は摩擦係数、$\xi(t)$はランダム力（ノイズ）である。ランダム力は以下の性質を持つ：

\begin{equation}
\int_t^{t+\Delta t} \xi(t) dt = \sqrt{2\gamma k_B T \Delta t} \eta
\label{eq:noise_integral}
\end{equation}

ここで、$k_B$はボルツマン定数、$T$は温度、$\eta$は平均0、分散1の標準正規分布に従う乱数である。

\subsection{数値スキーム}

時間を離散化し、$t_n = n\Delta t$とすると、数値スキームは以下のようになる：

\begin{equation}
v_{n+1} = v_n - \frac{\gamma}{m} v_n \Delta t + \sqrt{\frac{2\gamma k_B T}{m}} \sqrt{\Delta t} \eta_n
\label{eq:velocity_update}
\end{equation}

\begin{equation}
r_{n+1} = r_n + v_n \Delta t
\label{eq:position_update}
\end{equation}

ここで、$\eta_n = (\eta_{n,x}, \eta_{n,y})$は2次元の標準正規分布に従う乱数ベクトルである。

\subsection{平均二乗変位と拡散係数}

平均二乗変位（Mean Squared Displacement, MSD）は以下のように定義される：

\begin{equation}
\langle r^2(t) \rangle = \langle |r(t) - r(0)|^2 \rangle
\label{eq:msd}
\end{equation}

理論的には、2次元の場合、平均二乗変位は以下のように表される：

\begin{equation}
\langle r^2(t) \rangle = \frac{4k_B T}{\gamma} \left[ t - \frac{m}{\gamma}\left(1 - e^{-\gamma t/m}\right) \right]
\label{eq:msd_theory}
\end{equation}

長時間極限（$t \gg m/\gamma$）では、以下のように簡略化される：

\begin{equation}
\langle r^2(t) \rangle \approx \frac{4k_B T}{\gamma} t = 4Dt
\label{eq:msd_diffusion}
\end{equation}

ここで、拡散係数$D$は以下のように定義される：

\begin{equation}
D = \frac{k_B T}{\gamma}
\label{eq:diffusion_coefficient}
\end{equation}

\subsection{エネルギー分布関数}

熱平衡状態では、粒子の速度分布はマクスウェル分布に従う。2次元の場合、速度の大きさ$v = |\mathbf{v}|$の分布は以下のようになる：

\begin{equation}
P(v) = \frac{m v}{k_B T} \exp\left(-\frac{m v^2}{2k_B T}\right)
\label{eq:maxwell_velocity}
\end{equation}

運動エネルギー$E = \frac{1}{2}mv^2$の分布関数は、変数変換により以下のように表される：

\begin{equation}
P(E) = \frac{1}{k_B T} \exp\left(-\frac{E}{k_B T}\right)
\label{eq:energy_distribution}
\end{equation}

これは指数分布であり、ボルツマン因子$\exp(-E/(k_B T))$を含む。温度が高いほど、高いエネルギーを持つ粒子の確率が増加する。

\section{実装方法}

\subsection{Box-Muller法による正規分布乱数の生成}

正規分布に従う乱数を生成するために、Box-Muller法を使用した。この方法は、2つの一様乱数から標準正規分布に従う乱数を生成する。

\begin{lstlisting}[style=cstyle]
double normal_rand() {
    double u1, u2;
    u1 = (rand() + 1.0) / (RAND_MAX + 2.0);
    u2 = (rand() + 1.0) / (RAND_MAX + 2.0);
    return sqrt(-2.0 * log(u1)) * cos(2.0 * M_PI * u2);
}
\end{lstlisting}

\subsection{ブラウン運動のシミュレーション}

C言語で実装したブラウン運動のシミュレーションプログラムの主要部分を以下に示す：

\begin{lstlisting}[style=cstyle]
/* Time evolution */
for (int n = 0; n < n_steps; n++) {
    /* Generate random numbers for noise */
    double eta_x = normal_rand();
    double eta_y = normal_rand();
    
    /* Update velocity */
    vx = vx - coeff1 * vx * dt + coeff2 * sqrt(dt) * eta_x;
    vy = vy - coeff1 * vy * dt + coeff2 * sqrt(dt) * eta_y;
    
    /* Update position */
    rx = rx + vx * dt;
    ry = ry + vy * dt;
    
    /* Output */
    printf("%.15e %.15e %.15e %.15e %.15e\n", t, rx, ry, vx, vy);
}
\end{lstlisting}

\section{結果と考察}

\subsection{課題(1): 正規分布乱数の生成と検証}

Box-Muller法により生成した正規分布乱数のヒストグラムを図\ref{fig:normal_rand_50}、図\ref{fig:normal_rand_100}、図\ref{fig:normal_rand_1000}に示す。サンプル数が増えるにつれて、理論的な正規分布$N(0,1)$に近づくことが確認できる。サンプル数が少ない場合（n=50）では統計的なばらつきが大きいが、サンプル数を増やすと（n=1000）理論曲線により近づくことが分かる。

\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/normal_rand_hist_50.png}
\caption{正規分布乱数のヒストグラム（n=50）}
\label{fig:normal_rand_50}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/normal_rand_hist_100.png}
\caption{正規分布乱数のヒストグラム（n=100）}
\label{fig:normal_rand_100}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{figures/normal_rand_hist_1000.png}
\caption{正規分布乱数のヒストグラム（n=1000）}
\label{fig:normal_rand_1000}
\end{figure}

\subsection{課題(2)・(3): ブラウン運動の軌道}

初期条件$r_0 = (0, 0)$、$v_0 = (0, 0)$から開始したブラウン運動の2次元軌道を5回実行し、結果を重ねて表示した（図\ref{fig:trajectories}）。各軌道は異なるランダムウォークを示し、粒子が拡散していく様子が観察される。

\paragraph{物理的考察}
各軌道は、ランダム力$\xi(t)$の影響により異なる経路をたどる。粒子は原点から出発し、ランダムな力を受けて拡散していく。時間が経過するにつれて、粒子の位置のばらつきが大きくなり、拡散の効果が顕著になる。各実行で異なる軌道が得られることは、ブラウン運動の確率的性質を反映している。また、2次元空間での拡散により、粒子は原点から離れる方向に移動する傾向がある。

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{figures/trajectories_2d.png}
\caption{ブラウン運動の2次元軌道（5回実行）}
\label{fig:trajectories}
\end{figure}

\subsection{課題(4): 平均二乗変位の計算}

5回のシミュレーション結果から平均二乗変位を計算し、理論値と比較した（図\ref{fig:msd}）。図には、5回の個別試行の結果を色分けして重ねて表示し、さらに各時間においてこれら5回の平均をとったものも太い黒線で表示している。シミュレーション結果は理論値と定性的に一致しており、長時間極限では拡散領域（$\langle r^2(t) \rangle \approx 4Dt$）に漸近する傾向が確認できる。ただし、統計的なばらつきや数値計算の誤差により、完全な一致は見られない。個別の試行結果には統計的なばらつきが見られるが、平均をとることにより理論値に近づくことが確認できる。

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{figures/msd_plot.png}
\caption{平均二乗変位の時間発展（理論値との比較）}
\label{fig:msd}
\end{figure}

拡散係数$D = k_B T / \gamma$の理論値は、パラメータ$T=1.0$、$m=1.0$、$\gamma=1.0$、$k_B=1.0$の場合、$D = 1.0$となる。シミュレーションからフィッティングした拡散係数は理論値と定性的に一致する傾向を示したが、統計的なばらつきや有限時間での平均化による誤差が存在する。

\paragraph{物理的考察}
平均二乗変位の時間発展は、以下の3つの領域に分けられる：
\begin{enumerate}
\item \textbf{慣性領域}（$t \ll m/\gamma$）：粒子の慣性が支配的で、$\langle r^2(t) \rangle \propto t^2$の挙動を示す。
\item \textbf{遷移領域}（$t \sim m/\gamma$）：慣性から拡散への遷移が起こる。
\item \textbf{拡散領域}（$t \gg m/\gamma$）：拡散が支配的で、$\langle r^2(t) \rangle \approx 4Dt$の線形関係が成立する。
\end{enumerate}

図\ref{fig:msd}から、短時間では理論値（完全な式）と拡散極限に差があるが、時間が経過するにつれて両者が一致することが確認できる。これは、粒子が慣性領域から拡散領域へ遷移する過程を示している。

\subsection{課題(5): 拡散係数の解析的導出とパラメータ依存性}

課題(4)と同様に、各パラメータ（温度$T$、質量$m$、摩擦係数$\gamma$）を変化させてシミュレーションを実行し、平均二乗変位の時間発展を調べた。図\ref{fig:msd_params}に、各パラメータについての平均二乗変位の時間発展を示す。各図では、複数のパラメータ値について平均二乗変位を重ねて表示し、理論値（破線）と比較している。

\begin{figure}[H]
\centering
\includegraphics[width=0.95\textwidth]{figures/msd_parameter_dependence.png}
\caption{各パラメータについての平均二乗変位の時間発展（左：温度依存性、中央：質量依存性、右：摩擦係数依存性）}
\label{fig:msd_params}
\end{figure}

図\ref{fig:msd_params}から、以下のことが確認できる：
\begin{itemize}
\item \textbf{温度依存性}（左図）：温度が高いほど、平均二乗変位の増加率が大きくなる。これは、高温では拡散が促進されることを示している。
\item \textbf{質量依存性}（中央図）：質量が異なっても、長時間での平均二乗変位の傾きはほぼ同じである。これは、拡散係数が質量に依存しないことを示している。ただし、短時間では質量が小さいほど拡散が速く始まる傾向が見られる。
\item \textbf{摩擦係数依存性}（右図）：摩擦係数が大きいほど、平均二乗変位の増加率が小さくなる。これは、摩擦が大きいほど拡散が抑制されることを示している。
\end{itemize}

次に、各パラメータについて平均二乗変位の傾きから拡散係数$D$を求め、理論値と比較する。

\subsubsection{拡散係数の解析的導出}

拡散係数$D$は、平均二乗変位の長時間極限から導出できる。式(\ref{eq:msd_theory})において、$t \gg m/\gamma$の極限を取ると：

\begin{equation}
\langle r^2(t) \rangle \approx \frac{4k_B T}{\gamma} t = 4Dt
\end{equation}

したがって、拡散係数は以下のように定義される：

\begin{equation}
D = \frac{k_B T}{\gamma}
\label{eq:diffusion_derivation}
\end{equation}

この関係式はアインシュタインの関係式として知られており、統計力学の基本的な結果である。拡散係数は、熱揺らぎ（温度$T$）と摩擦（$\gamma$）のバランスによって決まる。

\subsubsection{温度依存性}

拡散係数は温度$T$に比例する：$D = k_B T / \gamma$。これは、温度が高いほど熱揺らぎが大きくなり、粒子の拡散が促進されることを意味する。温度を$T = 0.5, 1.0, 2.0, 5.0$の4通りに変化させてシミュレーションを実行し、各温度について平均二乗変位の傾きから拡散係数を求めた。図\ref{fig:param_dep}（左）に示すように、シミュレーション結果は理論値$D = k_B T / \gamma$と定性的に一致する傾向を示し、温度依存性の基本的な関係は確認できた。温度が高いほど拡散係数が大きくなり、粒子の拡散が促進されることが確認された。

\subsubsection{質量依存性}

拡散係数は質量$m$に依存しない。これは、拡散係数が長時間極限での平均二乗変位の傾きから決定されるためである。質量は短時間の挙動（慣性領域）に影響するが、長時間の拡散挙動には影響しない。質量を$m = 0.5, 1.0, 2.0$の3通りに変化させてシミュレーションを実行し、各質量について平均二乗変位の傾きから拡散係数を求めた。

図\ref{fig:param_dep}（中央）に示すように、理論的には拡散係数は質量に依存せず、$D = k_B T / \gamma$で一定である。シミュレーション結果もこの理論予測と一致し、質量が変化しても拡散係数はほぼ一定であることが確認された。

ただし、質量が大きい場合、緩和時間$\tau = m/\gamma$が長くなるため、拡散領域に達するにはより長い時間が必要である。本シミュレーションでは総時間$t=10$で計算しているが、質量$m=2.0$の場合、$\tau=2.0$となり、$t/\tau=5$と比較的短い。このため、拡散領域に完全に達する前にシミュレーションが終了し、フィッティングによる拡散係数の推定に大きな誤差が生じる可能性がある。質量が小さい場合（$m=0.5$、$\tau=0.5$、$t/\tau=20$）では、より長時間の拡散領域が観測され、より正確な拡散係数の推定が可能である。

\subsubsection{摩擦係数依存性}

拡散係数は摩擦係数$\gamma$に反比例する：$D = k_B T / \gamma$。摩擦が大きいほど、粒子の拡散は遅くなる。これは、摩擦が粒子の運動を抑制するためである。摩擦係数を$\gamma = 0.5, 1.0, 2.0$の3通りに変化させてシミュレーションを実行し、各摩擦係数について平均二乗変位の傾きから拡散係数を求めた。図\ref{fig:param_dep}（右）に示すように、摩擦係数を増加させると拡散係数は減少し、理論予測$D = k_B T / \gamma$と一致している。摩擦が大きいほど、粒子の運動が抑制され、拡散が遅くなることが確認された。

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{figures/diffusion_parameter_dependence.png}
\caption{拡散係数のパラメータ依存性（温度、質量、摩擦係数の依存性）}
\label{fig:param_dep}
\end{figure}

\subsection{課題(6): エネルギー分布関数}

粒子の運動エネルギーは水分子からの衝突を受け、常に変化している。シミュレーションで得られた速度データから運動エネルギー$E = \frac{1}{2}m(v_x^2 + v_y^2)$を計算し、その分布関数を調べた。

温度を$T = 0.5, 1.0, 2.0$の3通りに変化させ、各温度について10回のシミュレーションを実行し、得られた全データからエネルギー分布を計算した。階級数は30としてヒストグラムを作成した。

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{figures/energy_distribution.png}
\caption{粒子の運動エネルギー分布関数（温度依存性）}
\label{fig:energy_dist}
\end{figure}

図\ref{fig:energy_dist}に示すように、温度が高いほど、高いエネルギーを持つ粒子の確率が増加している。これは、高温では熱揺らぎが大きくなり、粒子がより高いエネルギー状態に励起されることを示している。

次に、理論的な分布関数（式(\ref{eq:energy_distribution})）と比較した結果を図\ref{fig:energy_theory}に示す。

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{figures/energy_distribution_with_theory.png}
\caption{粒子の運動エネルギー分布関数（理論値との比較）}
\label{fig:energy_theory}
\end{figure}

\paragraph{物理的考察}
図\ref{fig:energy_theory}から、シミュレーション結果は理論的な指数分布$P(E) = \frac{1}{k_B T} \exp(-E/(k_B T))$と定性的に一致していることが確認できる。これは、熱平衡状態における粒子のエネルギー分布がボルツマン分布に従うことを示している。

エネルギー分布関数は指数関数$\exp(-E/(k_B T))$で近似される。この分布は以下の特徴を持つ：

\begin{enumerate}
\item \textbf{温度依存性}：温度$T$が高いほど、分布の減衰が緩やかになり、高いエネルギーを持つ粒子の確率が増加する。これは、高温では熱揺らぎにより粒子がより高いエネルギー状態に励起されることを意味する。
\item \textbf{指数減衰}：エネルギーが増加するにつれて、その確率は指数関数的に減少する。これは、ボルツマン因子$\exp(-E/(k_B T))$の効果である。
\item \textbf{特性エネルギー}：分布の減衰の速さは$k_B T$によって決まる。$k_B T$は熱エネルギーを表し、この値が大きいほど、より高いエネルギー状態が実現しやすくなる。
\end{enumerate}

この結果は、統計力学における等分配定理やマクスウェル分布と一致しており、数値シミュレーションが正しく熱平衡状態を再現していることを示している。また、ランジュバン方程式によるブラウン運動のシミュレーションが、熱平衡状態における粒子の統計的性質を適切に記述していることが確認された。

\end{document}

