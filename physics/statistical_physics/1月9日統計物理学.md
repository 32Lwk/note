# 統計物理学Ⅰ・演習7 解答

## 問題の概要

本演習では、統計力学の基礎となる以下の4つのセクションを扱います：

1. **I. スターリングの公式**: 大きな自然数に対する階乗の近似式をガンマ関数と鞍点近似を用いて証明します。
2. **II. D次元球の体積**: ガンマ関数を用いたD次元球の体積公式を導出します。
3. **III. N個の独立な調和振動子**: 量子力学的な調和振動子系の統計力学的扱いを解析します。
4. **IV. 古典理想気体**: 古典理想気体の分配関数と熱力学量を計算します。

---

# I. スターリングの公式

## 問題の概要

大きな自然数 $N$ に対して成立する近似式、**スターリングの公式**：

**式(1):**
$$N! \approx \sqrt{2\pi N} N^N e^{-N} \tag{1}$$

を証明します。この公式は統計力学において、大きな系のエントロピーや分配関数を計算する際に頻繁に用いられます。

---

## 問1: ガンマ関数と階乗の関係

**問題:** ガンマ関数

**式(2):**
$$\Gamma(x) = \int_0^{\infty} dt \, t^{x-1} e^{-t} \tag{2}$$

を用いて、$N! = \Gamma(N+1)$ と書けることを示せ。

**解答:**

ガンマ関数の定義式(2)において、$x = N+1$ とすると：

$$\Gamma(N+1) = \int_0^{\infty} dt \, t^{(N+1)-1} e^{-t} = \int_0^{\infty} dt \, t^N e^{-t}$$

**部分積分による導出:**

$u = t^N$, $dv = e^{-t} dt$ とおくと、$du = N t^{N-1} dt$, $v = -e^{-t}$ より：

$$\Gamma(N+1) = \left[-t^N e^{-t}\right]_0^{\infty} + N \int_0^{\infty} dt \, t^{N-1} e^{-t}$$

第一項は $t \to 0$ と $t \to \infty$ での値を評価：
- $t \to 0$: $t^N e^{-t} \to 0$（$N \geq 1$ のとき）
- $t \to \infty$: $t^N e^{-t} \to 0$（指数関数が支配的）

したがって：

$$\Gamma(N+1) = N \int_0^{\infty} dt \, t^{N-1} e^{-t} = N \Gamma(N)$$

この関係式を繰り返し適用すると：

$$\Gamma(N+1) = N \Gamma(N) = N (N-1) \Gamma(N-1) = \cdots = N! \Gamma(1)$$

$\Gamma(1) = \int_0^{\infty} dt \, e^{-t} = \left[-e^{-t}\right]_0^{\infty} = 1$ より：

$$\Gamma(N+1) = N!$$

**物理的意味:**
- ガンマ関数は階乗の連続化（実数への拡張）を与えます
- 統計力学では、大きな $N$ に対する $N!$ の近似が必要であり、ガンマ関数の性質を利用します

---

## 問2: 被積分関数の概形

**問題:** $\Gamma(x+1)$ の被積分関数 $t^x e^{-t}$ の概形を、$t$ の関数としてスケッチせよ。

**解答:**

被積分関数を $f(t) = t^x e^{-t}$ とします。

**導関数の計算:**

$$f'(t) = x t^{x-1} e^{-t} - t^x e^{-t} = t^{x-1} e^{-t} (x - t)$$

$f'(t) = 0$ となる点は：
- $t = 0$（$x > 1$ のとき、極小点または変曲点）
- $t = x$（極大点）

**第二導関数:**

$$f''(t) = (x-1) t^{x-2} e^{-t} (x-t) - t^{x-1} e^{-t} + t^{x-1} e^{-t} (x-t)$$

$t = x$ での値を計算すると、$f''(x) < 0$ となり、確かに極大点です。

**関数の性質:**
- $t = 0$: $f(0) = 0$（$x > 0$ のとき）
- $t = x$: 極大値 $f(x) = x^x e^{-x}$
- $t \to \infty$: $f(t) \to 0$（指数関数が支配的）

**図2: ガンマ関数の被積分関数の概形**

![ガンマ関数の被積分関数](statistical_physics_fig5_gamma_integrand.png)

図では、$x=2$ と $x=5$ の場合の被積分関数 $t^x e^{-t}$ の概形が示されています。$t = x$ で極大値を取り、$t \to \infty$ で指数関数的に減少することが確認できます。この極大点付近が積分への主要な寄与を与えることが、鞍点近似の基礎となります。

**物理的意味:**
- 被積分関数は、$t = x$ 付近に鋭いピークを持ちます
- $x$ が大きいほど、このピークはより鋭く、より高くなります
- この性質により、大きな $x$ に対して鞍点近似が有効になります

---

## 問3: 鞍点近似によるガンマ関数の評価

**問題:** 式(4)の被積分関数を $t^x e^{-t} \equiv e^{-f(t)}$ と置こう。ここで、$f(t)$ が最小値を持つ点の周りで2次まで展開すると、

**式(3):**
$$f(t) = f(t^*) + \frac{1}{2}f''(t^*)(t-t^*)^2 \tag{3}$$

となる。よって、$x$ が十分に大きければ、近似的に、

**式(4):**
$$\Gamma(x + 1) = \sqrt{\frac{2\pi}{f''(t^*)}} \exp[-f(t^*)] \tag{4}$$

と書けることを示せ。また、具体的な値を代入して、式(1)を得ることを確認せよ。

**解答:**

被積分関数を $e^{-f(t)}$ の形に書き直します：

$$t^x e^{-t} = e^{-f(t)}$$

したがって：

$$f(t) = -x \ln t + t$$

**極小点の計算:**

$f'(t) = -\frac{x}{t} + 1 = 0$ より、$t^* = x$

**第二導関数:**

$$f''(t) = \frac{x}{t^2}$$

$t = t^* = x$ での値：

$$f''(t^*) = \frac{x}{x^2} = \frac{1}{x}$$

**極小値:**

$$f(t^*) = -x \ln x + x = x(1 - \ln x)$$

**テイラー展開:**

$f(t)$ を $t^*$ の周りで2次まで展開：

$$f(t) = f(t^*) + \frac{1}{2}f''(t^*)(t-t^*)^2 + \cdots$$

$$= x(1 - \ln x) + \frac{1}{2x}(t-x)^2 + \cdots$$

**積分の評価:**

$t = t^* + u = x + u$ と変数変換すると：

$$\Gamma(x+1) = \int_0^{\infty} dt \, t^x e^{-t} = \int_{-x}^{\infty} du \, (x+u)^x e^{-(x+u)}$$

$x$ が大きいとき、被積分関数は $u=0$（$t=x$）の周りに鋭いピークを持ちます。具体的には、$u \ll x$ の範囲で主要な寄与が得られます。

$u$ の範囲を $-\infty$ から $\infty$ に拡張する近似の妥当性を評価します：

$$\Gamma(x+1) = \int_{-x}^{\infty} du \, (x+u)^x e^{-(x+u)} = \int_{-x}^{\infty} du \, e^{-f(x+u)}$$

ここで、$f(t) = -x\ln t + t$ を $t=x$ の周りで展開：

$$f(x+u) = f(x) + \frac{1}{2}f''(x)u^2 + O(u^3) = x(1-\ln x) + \frac{1}{2x}u^2 + O(u^3)$$

したがって：

$$\Gamma(x+1) \approx \exp[-x(1-\ln x)] \int_{-x}^{\infty} du \, \exp\left[-\frac{1}{2x}u^2 + O(u^3)\right]$$

$|u| \gg \sqrt{x}$ の範囲では、被積分関数は指数関数的に小さくなるため、積分範囲を $-\infty$ から $\infty$ に拡張しても誤差は無視できます。具体的には：

$$\left|\int_{-\infty}^{-x} du \, \exp\left[-\frac{1}{2x}u^2\right]\right| \leq \int_{-\infty}^{-x} du \, \exp\left[-\frac{1}{2x}u^2\right] \sim O(e^{-x/2})$$

これは、主要項 $O(\sqrt{x})$ に対して $x \gg 1$ で無視できます。

したがって：

$$\Gamma(x+1) \approx \exp[-x(1-\ln x)] \int_{-\infty}^{\infty} du \, \exp\left[-\frac{1}{2x}u^2\right]$$

$$\approx \exp[-x(1-\ln x)] \int_{-\infty}^{\infty} du \, \exp\left[-\frac{1}{2x}u^2\right]$$

ガウス積分 $\int_{-\infty}^{\infty} du \, e^{-au^2} = \sqrt{\frac{\pi}{a}}$ を用いると：

$$\int_{-\infty}^{\infty} du \, \exp\left[-\frac{1}{2x}u^2\right] = \sqrt{2\pi x}$$

したがって：

$$\Gamma(x+1) \approx \sqrt{2\pi x} \exp[-x(1-\ln x)]$$

$$= \sqrt{2\pi x} \exp[-x + x\ln x] = \sqrt{2\pi x} \, x^x e^{-x}$$

**式(1)の導出:**

$\Gamma(N+1) = N!$ より：

$$N! \approx \sqrt{2\pi N} N^N e^{-N}$$

これで式(1)が得られました。

**物理的意味:**
- 鞍点近似（最急降下法）は、積分への主要な寄与が極値の周りから来ると仮定する方法です
- 大きな $x$ に対して、この近似は非常に良い精度を持ちます

---

## 問4: 相対誤差の計算

**問題:** 式(1)の左辺と右辺を、電卓などを使って計算し、たとえば、$N=8$ における相対誤差、$|$(厳密な値) - (近似値)$|$/(厳密な値)を求めよ。

**解答:**

$N = 8$ の場合を計算します。

**厳密な値:**

$$8! = 40320$$

**近似値（スターリングの公式）:**

$$8! \approx \sqrt{2\pi \cdot 8} \cdot 8^8 \cdot e^{-8}$$

各因子を計算：

- $\sqrt{2\pi \cdot 8} = \sqrt{16\pi} = 4\sqrt{\pi} \approx 4 \times 1.77245 \approx 7.0898$
- $8^8 = 16777216$
- $e^{-8} \approx 0.0003354626$

したがって：

$$8! \approx 7.0898 \times 16777216 \times 0.0003354626$$

$$\approx 39836.89$$

**相対誤差:**

$$\text{相対誤差} = \frac{|40320 - 39836.89|}{40320} = \frac{483.11}{40320} \approx 0.01198 \approx 1.20\%$$

**より正確な計算:**

実際には、スターリングの公式には高次の補正項があります。より正確な近似式：

$$N! \approx \sqrt{2\pi N} N^N e^{-N}\left(1 + \frac{1}{12N} + \frac{1}{288N^2} + \cdots\right)$$

$N=8$ の場合、補正項を含めると：

$$8! \approx \sqrt{16\pi} \cdot 8^8 \cdot e^{-8} \cdot \left(1 + \frac{1}{96}\right) \approx 39836.89 \times 1.01042 \approx 40243.8$$

これにより、相対誤差は約 0.19% に改善されます。

**考察:**
- $N=8$ という比較的小さな値でも、スターリングの公式の相対誤差は約1.2%と小さいです
- $N$ が大きくなるほど、相対誤差はさらに小さくなります
- 統計力学では $N \sim 10^{23}$（アボガドロ数）という非常に大きな値が扱われるため、スターリングの公式は非常に有効です

**誤差の評価:**

相対誤差は、$N$ が大きくなるにつれて約 $O(1/N)$ のオーダーで減少します。$N \sim 10^{23}$ の場合、相対誤差は約 $10^{-25}$ となり、実質的に無視できます。

**統計力学での重要性:**

スターリングの公式は、大きな $N$ に対する $\ln N!$ の評価において不可欠です。エントロピーや自由エネルギーの計算で頻繁に用いられます。

---

### 問4の補足: $N$ の技術的上限について

**Q: スターリングの公式は $N$ がどこまで大きくなっても使えるのか？技術的な上限は？**

**回答:**

スターリングの公式の適用範囲について、理論的・技術的な観点から詳しく説明します。

#### 1. 理論的な上限

**数学的には上限なし:**

スターリングの公式は、$N \to \infty$ の極限で厳密に成り立ちます。より正確には、相対誤差は $O(1/N)$ のオーダーで減少し続けます：

$$\text{相対誤差} \sim \frac{1}{12N} + \frac{1}{288N^2} + \cdots$$

したがって、$N$ が大きくなるほど精度は向上します。

#### 2. 計算機的な制約

**実用的な上限:**

実際の計算では、以下の制約があります：

**a) $N!$ の直接計算:**

- **倍精度浮動小数点数（64ビット）の上限**: 約 $1.8 \times 10^{308}$
- **$N!$ がオーバーフローする $N$**: 
  - $N = 170$: $170! \approx 7.26 \times 10^{306}$（ほぼ上限）
  - $N = 171$: $171! \approx 1.24 \times 10^{309}$（オーバーフロー）
- **結論**: $N!$ の直接計算は $N \lesssim 170$ が実用的な上限

**b) $\ln N!$ の計算:**

統計力学では通常 $\ln N!$ を計算するため、直接的なオーバーフローは避けられます。

- **スターリングの公式**: $\ln N! \approx N\ln N - N + \frac{1}{2}\ln(2\pi N)$
- **計算可能な範囲**: 
  - $N = 10^{10}$: $\ln N! \approx 2.3 \times 10^{11}$
  - $N = 10^{20}$: $\ln N! \approx 4.6 \times 10^{21}$
  - $N = 10^{23}$（アボガドロ数）: $\ln N! \approx 5.3 \times 10^{24}$
  - $N = 10^{30}$: $\ln N! \approx 6.9 \times 10^{31}$

**数値精度の制約:**

- **倍精度浮動小数点数の有効桁数**: 約15-17桁
- **$N \sim 10^{23}$ での相対誤差**: $O(1/N) \sim 10^{-25}$（数値精度の範囲内）
- **結論**: $\ln N!$ の計算は、$N \sim 10^{30}$ 程度まで実用的に可能

#### 3. 実用的な適用範囲

**統計力学での実際の使用:**

統計力学では、以下のような $N$ の値が扱われます：

| $N$ の範囲 | 用途 | 相対誤差 | 計算可能性 |
|-----------|------|---------|-----------|
| $N \sim 10$ | 小さな系の理論計算 | $\sim 0.8\%$ | $N!$ 直接計算可能 |
| $N \sim 10^2$ | 中程度の系 | $\sim 0.08\%$ | $N!$ 直接計算可能 |
| $N \sim 10^3$ | 大きな系の理論計算 | $\sim 0.008\%$ | $\ln N!$ 計算推奨 |
| $N \sim 10^6$ | マクロな系 | $\sim 8 \times 10^{-5}\%$ | $\ln N!$ 計算必須 |
| $N \sim 10^{23}$ | アボガドロ数（標準的な系） | $\sim 10^{-25}$ | $\ln N!$ 計算必須 |

#### 4. 具体的な数値計算

**様々な $N$ での相対誤差:**

| $N$ | 相対誤差（基本公式） | 相対誤差（補正項付き） | 計算方法 |
|-----|---------------------|---------------------|---------|
| 8   | 1.04%              | 0.18%              | $N!$ 直接計算 |
| 10  | 0.83%              | 0.14%              | $N!$ 直接計算 |
| 50  | 0.17%              | 0.03%              | $N!$ 直接計算 |
| 100 | 0.083%             | 0.014%             | $N!$ 直接計算 |
| 170 | 0.049%             | 0.008%             | $N!$ 直接計算（上限） |
| 1000| 0.0083%            | 0.0014%            | $\ln N!$ 計算 |
| $10^{23}$ | $\sim 10^{-25}$ | $\sim 10^{-26}$ | $\ln N!$ 計算 |

**アボガドロ数の場合:**

$$N_A \approx 6.022 \times 10^{23}$$

- **基本公式の相対誤差**: $\frac{1}{12N_A} \approx 1.38 \times 10^{-25}$
- **補正項付きの相対誤差**: $\frac{1}{288N_A^2} \approx 2.4 \times 10^{-49}$
- **$\ln N_A!$ の値**: $\approx 5.3 \times 10^{24}$
- **結論**: 実質的に無視できる誤差

#### 5. 計算手法による違い

**$\ln N!$ の計算（推奨される方法）:**

統計力学では、通常 $\ln N!$ を直接計算します：

$$\ln N! \approx N\ln N - N + \frac{1}{2}\ln(2\pi N) + \frac{1}{12N} - \frac{1}{360N^3} + \cdots$$

この方法の利点：
- $N!$ 自体を計算する必要がない
- オーバーフローの問題を回避できる
- $N \sim 10^{30}$ でも計算可能
- 数値精度が高い

**数値計算の例（Python）:**

```python
import math

# N = 10^23 の場合
N = 1e23
ln_N_factorial = N * math.log(N) - N + 0.5 * math.log(2 * math.pi * N)
# 補正項: + 1/(12*N) - 1/(360*N^3) + ...
correction = 1 / (12 * N)  # 約 1.38e-25
ln_N_factorial_corrected = ln_N_factorial + correction
```

**物理的意味:**

スターリングの公式は、統計力学における「大きな系の極限」を数学的に表現しています。$N \sim 10^{23}$ という現実的な系のサイズでも、この公式は極めて高い精度で成り立ち、統計力学の基礎となっています。技術的な制約は主に計算機の数値表現によるものであり、理論的な限界ではありません。

---

# II. D次元球の体積

## 問題の概要

半径 $R$ で $D$ 次元の球の体積は、ガンマ関数を用いて、

**式(5):**
$$V_D(R) = \frac{\pi^{D/2} R^D}{\Gamma(D/2 + 1)} \tag{5}$$

で与えられることを示します。

**式(6):**
$$V_D(R) = \int \cdots \int_{x_1^2 + \cdots + x_D^2 \leq R^2} dx_1 \cdots dx_D \tag{6}$$

です。

また、$V_D(R)$ は $R^D$ に比例し、$D$ 次元球の表面積は $dV_D(R)/dR = C_D R^{D-1}$ で与えられます。

---

## 問1: D次元ガウス積分（第1の方法）

**問題:** $D$ 次元ガウス積分

**式(7):**
$$I_D = \int_{-\infty}^{\infty} dx_1 \cdots \int_{-\infty}^{\infty} dx_D \exp[-x_1^2 - \cdots - x_D^2] \tag{7}$$

を計算する方法は2通りある。第1の方法は、変数ごとに積分する方法である。この積分を実行して $I_D$ を計算せよ。

**式(8):**
$$I_D = \left\{\int_{-\infty}^{\infty} dx_1 \exp[-x_1^2]\right\}^D \tag{8}$$

**解答:**

式(7)の積分は、各変数が独立であるため、因数分解できます：

$$I_D = \left(\int_{-\infty}^{\infty} dx_1 e^{-x_1^2}\right) \left(\int_{-\infty}^{\infty} dx_2 e^{-x_2^2}\right) \cdots \left(\int_{-\infty}^{\infty} dx_D e^{-x_D^2}\right)$$

各積分は同じ形なので：

$$I_D = \left(\int_{-\infty}^{\infty} dx \, e^{-x^2}\right)^D$$

**1次元ガウス積分の計算:**

$$\int_{-\infty}^{\infty} dx \, e^{-x^2} = \sqrt{\pi}$$

この結果は、$I_1^2$ を極座標で計算することで得られます：

$$I_1^2 = \left(\int_{-\infty}^{\infty} dx \, e^{-x^2}\right)^2 = \int_{-\infty}^{\infty} dx \int_{-\infty}^{\infty} dy \, e^{-(x^2+y^2)}$$

$$= \int_0^{2\pi} d\theta \int_0^{\infty} r \, dr \, e^{-r^2} = 2\pi \int_0^{\infty} r \, dr \, e^{-r^2}$$

$u = r^2$ と置くと、$du = 2r \, dr$ より：

$$= 2\pi \int_0^{\infty} \frac{1}{2} du \, e^{-u} = \pi \int_0^{\infty} du \, e^{-u} = \pi$$

したがって：

$$I_1 = \sqrt{\pi}$$

**D次元ガウス積分:**

$$I_D = (\sqrt{\pi})^D = \pi^{D/2}$$

**物理的意味:**
- $D$ 次元ガウス積分は、各次元での積分の積になります
- これは、ガウス関数が各変数について独立であることを反映しています

---

## 問2: D次元ガウス積分（第2の方法）

**問題:** 式(7)のもう一つの方法は、極座標に変換して積分する方法である。被積分関数は $\vec{r} = (x_1, \ldots, x_D)$ の大きさ $r = |\vec{r}|$ のみの関数であるため、積分は半径 $r$、厚さ $dr$ の球殻の体積 $C_D r^{D-1} dr$ を用いて書ける。

**式(9):**
$$I_D = \int_0^{\infty} dr \, C_D r^{D-1} e^{-r^2} \tag{9}$$

1. この式が $I_D = C_D \Gamma(D/2)/2$ に変形できることを示せ。
2. この結果と問1の結果を組み合わせて $C_D$ を計算せよ。

**解答:**

**1. 積分の変形:**

式(9)より：

$$I_D = C_D \int_0^{\infty} dr \, r^{D-1} e^{-r^2}$$

変数変換 $u = r^2$ を行います。

**変数変換の詳細:**

$u = r^2$ より、$du = \frac{du}{dr} dr = 2r \, dr$、したがって：

$$dr = \frac{du}{2r}$$

$r = \sqrt{u}$ より：

$$dr = \frac{du}{2\sqrt{u}}$$

これを積分に代入します。$r^{D-1} = (\sqrt{u})^{D-1} = u^{(D-1)/2}$ より：

$$I_D = C_D \int_0^{\infty} \frac{du}{2\sqrt{u}} \, (\sqrt{u})^{D-1} e^{-u}$$

$$= C_D \int_0^{\infty} \frac{du}{2\sqrt{u}} \, u^{(D-1)/2} e^{-u}$$

$$= C_D \int_0^{\infty} \frac{du}{2} \, u^{(D-2)/2} e^{-u}$$

$$= \frac{C_D}{2} \int_0^{\infty} du \, u^{(D/2)-1} e^{-u}$$

ガンマ関数の定義 $\Gamma(x) = \int_0^{\infty} dt \, t^{x-1} e^{-t}$ より：

$$I_D = \frac{C_D}{2} \Gamma\left(\frac{D}{2}\right)$$

**2. $C_D$ の計算:**

問1の結果 $I_D = \pi^{D/2}$ と組み合わせると：

$$\pi^{D/2} = \frac{C_D}{2} \Gamma\left(\frac{D}{2}\right)$$

したがって：

$$C_D = \frac{2\pi^{D/2}}{\Gamma(D/2)}$$

**物理的意味:**
- $C_D$ は $D$ 次元単位球の表面積を表します
- この結果は、球の体積と表面積の関係を表しています

---

## 問3: D次元球の体積 $V_D(R)$

**問題:** 問1、問2で得られた結果から $V_D(R)$ を計算せよ。

**解答:**

$D$ 次元球の体積は、半径 $R$ までの積分で与えられます：

$$V_D(R) = \int_0^{R} dr \, C_D r^{D-1}$$

$$= C_D \int_0^{R} dr \, r^{D-1} = C_D \left[\frac{r^D}{D}\right]_0^{R} = \frac{C_D R^D}{D}$$

問2の結果 $C_D = \frac{2\pi^{D/2}}{\Gamma(D/2)}$ を代入：

$$V_D(R) = \frac{2\pi^{D/2}}{\Gamma(D/2)} \cdot \frac{R^D}{D}$$

ガンマ関数の性質 $\Gamma(x+1) = x\Gamma(x)$ より：

$$\Gamma\left(\frac{D}{2} + 1\right) = \frac{D}{2} \Gamma\left(\frac{D}{2}\right)$$

したがって：

$$\frac{1}{\Gamma(D/2)} = \frac{D/2}{\Gamma(D/2 + 1)} = \frac{D}{2\Gamma(D/2 + 1)}$$

これを代入すると：

$$V_D(R) = \frac{2\pi^{D/2}}{D} \cdot \frac{D}{2\Gamma(D/2 + 1)} R^D = \frac{\pi^{D/2} R^D}{\Gamma(D/2 + 1)}$$

これで式(5)が得られました。

**物理的意味:**
- $V_D(R)$ は $R^D$ に比例します（$D$ 次元での体積）
- ガンマ関数により、任意の次元での体積が統一的に表されます

**図3: D次元球の体積**

![D次元球の体積](statistical_physics_fig6_d_sphere_volume.png)

図では、$R=1$ の場合の各次元での球の体積が示されています。興味深いことに、体積は次元が増えるにつれて増加し、ある次元で最大値に達した後、減少します。

---

## 問4: 具体的な計算（D=2, D=3）

**問題:** 問3で得られた式を用いて、特に $D=2$ と $D=3$ の場合の $V_D(R)$ を具体的に計算し、正しいことを確かめよ。

**解答:**

**D=2 の場合（円）:**

$$\Gamma\left(\frac{2}{2} + 1\right) = \Gamma(2) = 1! = 1$$

したがって：

$$V_2(R) = \frac{\pi^{2/2} R^2}{\Gamma(2)} = \frac{\pi R^2}{1} = \pi R^2$$

これは、半径 $R$ の円の面積の公式と一致します。✓

**D=3 の場合（球）:**

$$\Gamma\left(\frac{3}{2} + 1\right) = \Gamma\left(\frac{5}{2}\right) = \frac{3}{2} \cdot \frac{1}{2} \cdot \Gamma\left(\frac{1}{2}\right) = \frac{3}{4} \sqrt{\pi}$$

$\Gamma(1/2) = \sqrt{\pi}$ を用いました。

したがって：

$$V_3(R) = \frac{\pi^{3/2} R^3}{\frac{3}{4}\sqrt{\pi}} = \frac{4\pi R^3}{3}$$

これは、半径 $R$ の球の体積の公式 $\frac{4}{3}\pi R^3$ と一致します。✓

**物理的意味:**
- 既知の2次元、3次元の結果と一致することから、一般の $D$ 次元での公式が正しいことが確認されます
- この公式は、統計力学において相空間の体積を計算する際に重要です

---

# III. N個の独立な調和振動子の統計力学的扱い

### 式(10)の導出と物理的意味

**式(10):**
$$E_l = \hbar\omega \left(m_l + \frac{1}{2}\right), \quad (m_l = 0, 1, 2, \ldots)$$

ここで、
- $E_l$: $l$番目の振動子のエネルギー
- $\hbar = h/(2\pi)$: 換算プランク定数（ディラック定数）
- $\omega$: 角振動数
- $m_l$: 量子数（0以上の整数）

### 導出の詳細

#### 1. 調和振動子のハミルトニアン

古典力学における調和振動子のハミルトニアンは：

$$H = \frac{p^2}{2m} + \frac{1}{2}m\omega^2 x^2$$

量子力学では、位置演算子 $\hat{x}$ と運動量演算子 $\hat{p}$ を用いて：

$$\hat{H} = \frac{\hat{p}^2}{2m} + \frac{1}{2}m\omega^2 \hat{x}^2$$

#### 2. 生成・消滅演算子による解法

生成演算子 $\hat{a}^\dagger$ と消滅演算子 $\hat{a}$ を導入：

$$\hat{a} = \sqrt{\frac{m\omega}{2\hbar}}\hat{x} + \frac{i}{\sqrt{2m\hbar\omega}}\hat{p}$$

$$\hat{a}^\dagger = \sqrt{\frac{m\omega}{2\hbar}}\hat{x} - \frac{i}{\sqrt{2m\hbar\omega}}\hat{p}$$

これらを用いると、ハミルトニアンは：

$$\hat{H} = \hbar\omega\left(\hat{a}^\dagger\hat{a} + \frac{1}{2}\right) = \hbar\omega\left(\hat{n} + \frac{1}{2}\right)$$

ここで、$\hat{n} = \hat{a}^\dagger\hat{a}$ は数演算子（number operator）です。

**交換関係の確認:**

生成・消滅演算子の交換関係 $[\hat{x}, \hat{p}] = i\hbar$ を用いると：

$$[\hat{a}, \hat{a}^\dagger] = \left[\sqrt{\frac{m\omega}{2\hbar}}\hat{x} + \frac{i}{\sqrt{2m\hbar\omega}}\hat{p}, \sqrt{\frac{m\omega}{2\hbar}}\hat{x} - \frac{i}{\sqrt{2m\hbar\omega}}\hat{p}\right]$$

$$= -\frac{i}{2\hbar}[\hat{x}, \hat{p}] + \frac{i}{2\hbar}[\hat{p}, \hat{x}] = -\frac{i}{2\hbar}(i\hbar) + \frac{i}{2\hbar}(-i\hbar) = \frac{1}{2} + \frac{1}{2} = 1$$

したがって、$[\hat{a}, \hat{a}^\dagger] = 1$ が成り立ちます。

#### 3. 固有値の導出

数演算子 $\hat{n} = \hat{a}^\dagger\hat{a}$ の固有値は、交換関係 $[\hat{a}, \hat{a}^\dagger] = 1$ から決定されます。

交換関係より、$\hat{a}^\dagger\hat{a} = \hat{a}\hat{a}^\dagger - 1$ なので：

$$\hat{n}\hat{a}^\dagger = \hat{a}^\dagger\hat{a}\hat{a}^\dagger = \hat{a}^\dagger(\hat{a}\hat{a}^\dagger) = \hat{a}^\dagger(\hat{a}^\dagger\hat{a} + 1) = \hat{a}^\dagger(\hat{n} + 1)$$

したがって、$|n\rangle$ を $\hat{n}$ の固有状態（固有値 $n$）とすると、$\hat{a}^\dagger|n\rangle$ も $\hat{n}$ の固有状態で固有値は $n+1$ です。同様に、$\hat{a}|n\rangle$ は固有値 $n-1$ の固有状態です。

基底状態 $|0\rangle$ は $\hat{a}|0\rangle = 0$ を満たし、$\hat{n}|0\rangle = 0$ より固有値は $0$ です。この状態に $\hat{a}^\dagger$ を繰り返し適用することで、すべての固有状態が得られ、固有値は非負の整数 $m_l = 0, 1, 2, \ldots$ となります。

したがって、対応する固有状態を $|m_l\rangle$ と表すと：

$$\hat{n}|m_l\rangle = m_l|m_l\rangle$$

ハミルトニアンの固有値は：

$$E_l = \hbar\omega\left(m_l + \frac{1}{2}\right)$$

### 物理的意味と考察

#### 零点エネルギー（Zero-Point Energy）

式(10)において、$m_l = 0$ のとき：

$$E_0 = \frac{1}{2}\hbar\omega$$

これは**零点エネルギー**と呼ばれ、量子力学における重要な概念です。

**物理的意味:**
- 古典力学では、最低エネルギー状態は $E = 0$（静止状態）ですが、量子力学では不確定性原理により、位置と運動量を同時に0にすることができません。
- その結果、最低エネルギー状態でも $\frac{1}{2}\hbar\omega$ のエネルギーを持ちます。
- これは、量子効果による「零点振動」を表しています。

#### エネルギー準位の等間隔性

$$E_{m_l+1} - E_{m_l} = \hbar\omega$$

エネルギー準位は等間隔 $\hbar\omega$ で並んでいます。これは調和振動子の特徴的な性質です。

**図1: 調和振動子のエネルギー準位**

![調和振動子のエネルギー準位](statistical_physics_fig1_energy_levels.png)

各準位間の間隔は一定で、$\Delta E = \hbar\omega$ です。図では、各エネルギー準位 $E_m = \hbar\omega(m + 1/2)$ が水平線で示されており、準位間の間隔が $\hbar\omega$ で一定であることが視覚的に確認できます。また、$m=0$ の基底状態でも零点エネルギー $\hbar\omega/2$ が存在することが示されています。

---

## II. カノニカル分布と確率

### 式(11)の導出と物理的意味

**式(11):**
$$P(i) = \frac{e^{-\beta E_i}}{Z_N}$$

ここで、
- $P(i)$: 系が量子状態 $i$ にある確率
- $\beta = 1/(k_B T)$: 逆温度パラメータ
- $E_i$: 状態 $i$ における系の全エネルギー
- $Z_N$: 分配関数（partition function）

### 導出の詳細

#### 1. カノニカル分布の原理

系が温度 $T$ の大きな熱浴（heat reservoir）と接触している場合、系は**カノニカル分布**（canonical distribution）に従います。

**統計力学の基本原理:**
- 系と熱浴を合わせた全体は孤立系として扱える
- 等重率の原理：すべての微視的状態が等しい確率で実現される
- 熱浴は十分に大きく、系のエネルギー変化の影響を受けない

#### 2. ボルツマン因子の導出

熱浴の状態数を $W_{\text{bath}}(E_{\text{total}} - E_i)$ とすると、系が状態 $i$ にある確率は：

$$P(i) \propto W_{\text{bath}}(E_{\text{total}} - E_i)$$

熱浴のエントロピーは：

$$S_{\text{bath}} = k_B \ln W_{\text{bath}}$$

したがって：

$$W_{\text{bath}}(E_{\text{total}} - E_i) = \exp\left(\frac{S_{\text{bath}}(E_{\text{total}} - E_i)}{k_B}\right)$$

熱浴の温度を $T$ とすると、熱力学関係式より：

$$\frac{1}{T} = \frac{\partial S_{\text{bath}}}{\partial E_{\text{bath}}}$$

$E_{\text{total}} \gg E_i$ のとき、テイラー展開：

$$S_{\text{bath}}(E_{\text{total}} - E_i) \approx S_{\text{bath}}(E_{\text{total}}) - \frac{E_i}{T}$$

したがって：

$$P(i) \propto \exp\left(-\frac{E_i}{k_B T}\right) = e^{-\beta E_i}$$

ここで、$\beta = 1/(k_B T)$ です。

#### 3. 規格化定数としての分配関数

確率の規格化条件：

$$\sum_i P(i) = 1$$

より：

$$P(i) = \frac{e^{-\beta E_i}}{\sum_j e^{-\beta E_j}} = \frac{e^{-\beta E_i}}{Z_N}$$

ここで、分配関数 $Z_N$ は：

$$Z_N = \sum_i e^{-\beta E_i}$$

### 物理的意味と考察

#### ボルツマン因子 $e^{-\beta E_i}$ の意味

**物理的解釈:**
- エネルギーが高い状態ほど、実現される確率が低い（指数関数的に減少）
- 温度が高いほど、高エネルギー状態が実現されやすくなる
- $\beta$ は「逆温度」を表し、$\beta \to 0$（高温極限）ではすべての状態が等確率に近づく

**図2: ボルツマン因子の温度依存性**

![ボルツマン因子の温度依存性](statistical_physics_fig2_boltzmann.png)

温度が高いほど、高エネルギー状態の確率が大きくなります。図では、異なる温度 $T = 0.5, 1.0, 2.0$ におけるボルツマン因子 $e^{-\beta E}$ のエネルギー依存性が示されています。温度が高いほど、同じエネルギーでも確率が高くなり、より多くの高エネルギー状態が実現されやすくなることが分かります。

#### 分配関数 $Z_N$ の重要性

分配関数は統計力学の中心的な概念であり、以下の理由で重要です：

1. **すべての熱力学量の源**: 分配関数から、内部エネルギー、エントロピー、自由エネルギーなど、すべての熱力学量を導出できます
2. **状態数の重み付き和**: 各状態のボルツマン因子の和として、系の統計的性質を集約的に表現
3. **規格化定数**: 確率分布の規格化を保証

---

## III. 系全体のエネルギー

### 式(12)の導出と物理的意味

**式(12):**
$$E_i = \hbar\omega\left(m_1 + m_2 + \cdots + m_N + \frac{N}{2}\right) \equiv \hbar\omega\left(M + \frac{N}{2}\right)$$

ここで、
- $E_i$: 系全体のエネルギー（状態 $i$ における）
- $m_1, m_2, \ldots, m_N$: 各振動子の量子数
- $M = m_1 + m_2 + \cdots + m_N$: 全量子数の和
- $i = (m_1, m_2, \ldots, m_N)$: 量子状態を指定するラベル

### 導出の詳細

#### 1. 独立な系のエネルギー

$N$個の振動子が**独立**（independent）であるとは、各振動子が互いに相互作用せず、それぞれが独自の量子状態を取れることを意味します。

各振動子のエネルギーは式(10)より：

$$E_l = \hbar\omega\left(m_l + \frac{1}{2}\right), \quad l = 1, 2, \ldots, N$$

#### 2. 全エネルギーの和

系全体のエネルギーは、各振動子のエネルギーの和です：

$$E_i = \sum_{l=1}^N E_l = \sum_{l=1}^N \hbar\omega\left(m_l + \frac{1}{2}\right)$$

$$= \hbar\omega\sum_{l=1}^N m_l + \hbar\omega\sum_{l=1}^N \frac{1}{2}$$

$$= \hbar\omega\left(m_1 + m_2 + \cdots + m_N\right) + \hbar\omega \cdot \frac{N}{2}$$

$$= \hbar\omega M + \hbar\omega \cdot \frac{N}{2}$$

$$= \hbar\omega\left(M + \frac{N}{2}\right)$$

ここで、$M = \sum_{l=1}^N m_l$ と定義しました。

### 物理的意味と考察

#### 零点エネルギー項 $\frac{N}{2}\hbar\omega$

**物理的解釈:**
- $N$個の振動子それぞれが零点エネルギー $\frac{1}{2}\hbar\omega$ を持つため、系全体の零点エネルギーは $\frac{N}{2}\hbar\omega$ となります
- これは、すべての振動子が基底状態（$m_l = 0$）にある場合のエネルギーです
- 温度が絶対零度に近づいても、この零点エネルギーは残ります（第三法則との関係）

#### 励起エネルギー項 $M\hbar\omega$

**物理的解釈:**
- $M = \sum_{l=1}^N m_l$ は、すべての振動子の励起レベルの合計です
- 各振動子が1つ上の準位に励起されると、エネルギーが $\hbar\omega$ だけ増加します
- この項は温度に依存し、温度が高いほど大きな値になります

#### 状態の縮退

同じ全エネルギー $E_i = \hbar\omega(M + N/2)$ を持つ状態が複数存在する場合があります。

**例:**
- $N = 3$, $M = 2$ の場合
  - $(m_1, m_2, m_3) = (2, 0, 0)$
  - $(m_1, m_2, m_3) = (0, 2, 0)$
  - $(m_1, m_2, m_3) = (0, 0, 2)$
  - $(m_1, m_2, m_3) = (1, 1, 0)$
  - $(m_1, m_2, m_3) = (1, 0, 1)$
  - $(m_1, m_2, m_3) = (0, 1, 1)$

これらはすべて同じエネルギー $E = \hbar\omega(2 + 3/2) = \frac{7}{2}\hbar\omega$ を持ちます。

**図3: エネルギー準位と状態の縮退**

![エネルギー準位と状態の縮退](statistical_physics_fig3_degeneracy.png)

同じ全エネルギー $E = \hbar\omega(M + N/2)$ を持つ複数の量子状態が存在する場合、これを「縮退」と呼びます。図では $N=3$ の場合を示しており、$M=0$ では1つの状態、$M=1$ では3つの状態、$M=2$ では6つの状態が同じエネルギーを持っています。この縮退は、統計力学において重要な役割を果たします。

---

## IV. 分配関数の計算

### 分配関数 $Z_N$ の導出

分配関数は、すべての可能な量子状態についてのボルツマン因子の和です：

$$Z_N = \sum_i e^{-\beta E_i}$$

状態 $i = (m_1, m_2, \ldots, m_N)$ について、各 $m_l$ は独立に $0, 1, 2, \ldots$ の値を取れるため：

$$Z_N = \sum_{m_1=0}^\infty \sum_{m_2=0}^\infty \cdots \sum_{m_N=0}^\infty e^{-\beta \hbar\omega(M + N/2)}$$

$$= e^{-\beta \hbar\omega N/2} \sum_{m_1=0}^\infty \sum_{m_2=0}^\infty \cdots \sum_{m_N=0}^\infty e^{-\beta \hbar\omega M}$$

$$= e^{-\beta \hbar\omega N/2} \sum_{m_1=0}^\infty \sum_{m_2=0}^\infty \cdots \sum_{m_N=0}^\infty e^{-\beta \hbar\omega(m_1 + m_2 + \cdots + m_N)}$$

各振動子が独立であるため、和は因数分解できます：

$$Z_N = e^{-\beta \hbar\omega N/2} \left(\sum_{m_1=0}^\infty e^{-\beta \hbar\omega m_1}\right) \left(\sum_{m_2=0}^\infty e^{-\beta \hbar\omega m_2}\right) \cdots \left(\sum_{m_N=0}^\infty e^{-\beta \hbar\omega m_N}\right)$$

各和は同じ形なので：

$$Z_N = e^{-\beta \hbar\omega N/2} \left(\sum_{m=0}^\infty e^{-\beta \hbar\omega m}\right)^N$$

#### 等比級数の和

$$\sum_{m=0}^\infty e^{-\beta \hbar\omega m} = \sum_{m=0}^\infty \left(e^{-\beta \hbar\omega}\right)^m = \frac{1}{1 - e^{-\beta \hbar\omega}}$$

ただし、$e^{-\beta \hbar\omega} < 1$（$\beta > 0$, $\hbar\omega > 0$）のとき収束します。

したがって：

$$Z_N = e^{-\beta \hbar\omega N/2} \left(\frac{1}{1 - e^{-\beta \hbar\omega}}\right)^N$$

$$= \left(\frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}\right)^N$$

#### 1つの振動子の分配関数

1つの振動子の分配関数を $Z_1$ とすると：

$$Z_1 = \frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}} = \frac{1}{e^{\beta \hbar\omega/2} - e^{-\beta \hbar\omega/2}} = \frac{1}{2\sinh(\beta \hbar\omega/2)}$$

したがって：

$$Z_N = (Z_1)^N$$

これは、独立な系の分配関数が各系の分配関数の積になることを示しています。

### 物理的意味と考察

#### 分配関数の温度依存性

**低温極限 ($T \to 0$, $\beta \to \infty$):**
$$Z_N \approx e^{-\beta \hbar\omega N/2} = e^{-N\hbar\omega/(2k_B T)}$$

- 分配関数は主に基底状態からの寄与
- 零点エネルギー項が支配的

**高温極限 ($T \to \infty$, $\beta \to 0$):**
$$e^{-\beta \hbar\omega} \approx 1 - \beta \hbar\omega$$

$$Z_N \approx \left(\frac{1}{\beta \hbar\omega}\right)^N = \left(\frac{k_B T}{\hbar\omega}\right)^N$$

- 多くの励起状態が寄与
- 古典統計力学の結果に近づく

---

## V. 熱力学量の導出

### ヘルムホルツの自由エネルギー

分配関数から、ヘルムホルツの自由エネルギー $F$ を導出できます：

$$F = -k_B T \ln Z_N$$

**導出:**
統計力学と熱力学の対応関係から：

$$F = E - TS$$

また、内部エネルギーは：

$$E = \langle E_i \rangle = \frac{1}{Z_N}\sum_i E_i e^{-\beta E_i} = -\frac{\partial \ln Z_N}{\partial \beta}$$

これらの関係から、$F = -k_B T \ln Z_N$ が導かれます。

### 内部エネルギー

内部エネルギーは、分配関数から以下のように導出されます：

$$E = \langle E_i \rangle = \frac{1}{Z_N}\sum_i E_i e^{-\beta E_i} = -\frac{\partial \ln Z_N}{\partial \beta}$$

分配関数 $Z_N = \left(\frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}\right)^N$ より：

$$\ln Z_N = N\left[-\frac{\beta \hbar\omega}{2} - \ln(1 - e^{-\beta \hbar\omega})\right]$$

これを $\beta$ で微分すると：

$$\frac{\partial \ln Z_N}{\partial \beta} = N\left[-\frac{\hbar\omega}{2} + \frac{\hbar\omega e^{-\beta \hbar\omega}}{1 - e^{-\beta \hbar\omega}}\right]$$

$$= N\left[-\frac{\hbar\omega}{2} + \frac{\hbar\omega}{e^{\beta \hbar\omega} - 1}\right]$$

したがって：

$$E = -\frac{\partial \ln Z_N}{\partial \beta} = N\hbar\omega\left(\frac{1}{2} + \frac{1}{e^{\beta \hbar\omega} - 1}\right)$$

**物理的解釈:**
- 第一項 $\frac{N}{2}\hbar\omega$: 零点エネルギー（温度に依存しない）
- 第二項 $\frac{N\hbar\omega}{e^{\beta \hbar\omega} - 1}$: 熱励起によるエネルギー（温度に依存）

**温度依存性:**
- **低温極限** ($T \to 0$, $\beta \to \infty$): $E \approx \frac{N}{2}\hbar\omega$（零点エネルギーのみ）
- **高温極限** ($T \to \infty$, $\beta \to 0$): $E \approx Nk_B T$（古典統計力学の結果）

### 比熱

比熱は内部エネルギーを温度で微分することで得られます：

$$C_V = \frac{\partial E}{\partial T}$$

$\beta = 1/(k_B T)$ より、$\frac{\partial \beta}{\partial T} = -\frac{1}{k_B T^2} = -\frac{\beta}{T}$ であることに注意すると：

$$C_V = \frac{\partial E}{\partial \beta} \cdot \frac{\partial \beta}{\partial T} = -\frac{\beta}{T} \cdot \frac{\partial E}{\partial \beta}$$

内部エネルギー $E = N\hbar\omega\left(\frac{1}{2} + \frac{1}{e^{\beta \hbar\omega} - 1}\right)$ を $\beta$ で微分：

$$\frac{\partial E}{\partial \beta} = N\hbar\omega \cdot \frac{-\hbar\omega e^{\beta \hbar\omega}}{(e^{\beta \hbar\omega} - 1)^2} = -\frac{N(\hbar\omega)^2 e^{\beta \hbar\omega}}{(e^{\beta \hbar\omega} - 1)^2}$$

したがって：

$$C_V = -\frac{\beta}{T} \cdot \left(-\frac{N(\hbar\omega)^2 e^{\beta \hbar\omega}}{(e^{\beta \hbar\omega} - 1)^2}\right) = \frac{N(\hbar\omega)^2 \beta e^{\beta \hbar\omega}}{T(e^{\beta \hbar\omega} - 1)^2}$$

$\beta = 1/(k_B T)$ を代入して整理すると：

$$C_V = Nk_B \frac{(\beta \hbar\omega)^2 e^{\beta \hbar\omega}}{(e^{\beta \hbar\omega} - 1)^2}$$

これは**アインシュタイン比熱**の公式です。

**図4: 比熱の温度依存性（アインシュタイン比熱）**

![アインシュタイン比熱の温度依存性](statistical_physics_fig4_heat_capacity.png)

低温では指数関数的に減少し、高温では $Nk_B$（デュロン・プティの法則）に近づきます。図では、比熱 $C_V/(Nk_B)$ の温度依存性が示されており、アインシュタイン温度 $T_E = \hbar\omega/k_B$ を境に、低温側では急激に減少し、高温側では古典的なデュロン・プティの値に漸近することが分かります。これは、低温では量子効果が重要であり、高温では古典統計力学が適用できることを示しています。

### エントロピー

エントロピーは、ヘルムホルツの自由エネルギーから導出できます：

$$S = -\frac{\partial F}{\partial T}$$

$F = -k_B T \ln Z_N$ より：

$$S = -\frac{\partial}{\partial T}(-k_B T \ln Z_N) = k_B \ln Z_N + k_B T \frac{\partial \ln Z_N}{\partial T}$$

$\frac{\partial \ln Z_N}{\partial T} = \frac{\partial \ln Z_N}{\partial \beta} \cdot \frac{\partial \beta}{\partial T} = -\frac{E}{k_B T^2}$ であることを用いると：

$$S = k_B \ln Z_N + \frac{E}{T}$$

分配関数と内部エネルギーを代入することで、エントロピーの具体的な表式が得られます。

**物理的解釈:**
- エントロピーは、系の無秩序さを表す熱力学量です
- 温度が高いほど、より多くの状態が実現可能になり、エントロピーは増加します
- 絶対零度では、系は基底状態のみを取るため、エントロピーは0に近づきます（第三法則）

---

## VI. まとめと考察

### 問題の意義

1. **量子統計力学の基礎**: カノニカル分布と分配関数の概念を理解する
2. **独立な系の扱い**: 独立な系の分配関数が各系の分配関数の積になることを確認
3. **零点エネルギー**: 量子効果による零点エネルギーの重要性を理解
4. **温度依存性**: 熱力学量の温度依存性を解析

### 物理的考察

#### 1. 古典極限との対応

高温極限では、量子効果が無視でき、古典統計力学の結果に一致します。これは**対応原理**の一例です。

#### 2. 零点エネルギーと第三法則

零点エネルギーは、絶対零度でも残るエネルギーであり、熱力学第三法則（$S \to 0$ as $T \to 0$）と整合的です。

#### 3. アインシュタイン模型との関係

本問題は、固体の比熱を説明する**アインシュタイン模型**の基礎となっています。各原子が独立な調和振動子として振る舞うと仮定することで、低温での比熱の減少を説明できます。

### 今後の発展

1. **デバイ模型**: 振動子の周波数分布を考慮したより現実的な模型
2. **ボース・アインシュタイン統計**: 同一粒子の統計的性質を考慮
3. **相関効果**: 振動子間の相互作用を考慮した拡張

### 結論

本問題では、$N$個の独立な調和振動子を量子力学的に扱い、統計力学の手法を用いて系の熱力学的性質を解析しました。主要な結果は以下の通りです：

1. **エネルギー準位**: 各振動子のエネルギーは $E_l = \hbar\omega(m_l + 1/2)$ で与えられ、零点エネルギー $\hbar\omega/2$ が存在する。

2. **カノニカル分布**: 温度 $T$ の熱浴と接触する系は、ボルツマン分布 $P(i) = e^{-\beta E_i}/Z_N$ に従う。

3. **分配関数**: 独立な系の分配関数は $Z_N = (Z_1)^N$ となり、各振動子の分配関数の積で表される。

4. **熱力学量**: 分配関数から、自由エネルギー $F = -k_B T \ln Z_N$、内部エネルギー $E$、比熱 $C_V$、エントロピー $S$ などの熱力学量を導出できる。

5. **温度依存性**: 低温では量子効果が重要であり、高温では古典統計力学の結果に一致する（対応原理）。

この問題は、量子統計力学の基礎を理解する上で重要な例題であり、固体の比熱を説明するアインシュタイン模型の基礎となっています。分配関数を計算することで、微視的な量子状態から巨視的な熱力学量を導出できることが確認できました。

---

## 参考文献・補足

### 重要な定数

- **ボルツマン定数**: $k_B = R/N_A \approx 1.38 \times 10^{-23}$ J/K
- **気体定数**: $R \approx 8.31$ J/(mol·K)
- **アボガドロ数**: $N_A \approx 6.02 \times 10^{23}$ mol⁻¹
- **換算プランク定数**: $\hbar = h/(2\pi) \approx 1.05 \times 10^{-34}$ J·s

### 関連する概念

- **カノニカル分布**: 温度一定の系の統計分布
- **分配関数**: 統計力学の中心的概念
- **ヘルムホルツの自由エネルギー**: $F = E - TS = -k_B T \ln Z$
- **内部エネルギー**: $E = -\partial \ln Z / \partial \beta$
- **エントロピー**: $S = k_B \ln Z + E/T$

### 参考文献

1. 田崎晴明, 「統計力学 I・II」, 培風館
2. 久保亮五, 「統計力学」, 共立出版
3. ランダウ・リフシッツ, 「統計物理学」, 東京図書
4. アインシュタイン, "Die Plancksche Theorie der Strahlung und die Theorie der spezifischen Wärme" (1907)

---

## VII. 問題への解答

以下、各問題について詳細に解答します。

### 問1: 平均エネルギーの分配関数による表現

**問題:** 一般にエネルギーの平均値は、以下のように分配関数で書けることを示せ。

**式(13):**
$$\langle E \rangle = -\frac{\partial}{\partial \beta} \ln Z_N \tag{13}$$

**解答:**

エネルギーの平均値は、確率分布による期待値として定義されます：

$$\langle E \rangle = \sum_i E_i P(i) = \sum_i E_i \frac{e^{-\beta E_i}}{Z_N} = \frac{1}{Z_N}\sum_i E_i e^{-\beta E_i}$$

ここで、分配関数 $Z_N = \sum_i e^{-\beta E_i}$ を $\beta$ で微分すると：

$$\frac{\partial Z_N}{\partial \beta} = \frac{\partial}{\partial \beta}\sum_i e^{-\beta E_i} = \sum_i \frac{\partial}{\partial \beta}e^{-\beta E_i} = \sum_i (-E_i) e^{-\beta E_i} = -\sum_i E_i e^{-\beta E_i}$$

したがって：

$$\sum_i E_i e^{-\beta E_i} = -\frac{\partial Z_N}{\partial \beta}$$

これを平均エネルギーの式に代入すると：

$$\langle E \rangle = \frac{1}{Z_N}\left(-\frac{\partial Z_N}{\partial \beta}\right) = -\frac{1}{Z_N}\frac{\partial Z_N}{\partial \beta}$$

対数関数の微分公式 $\frac{d}{dx}\ln f(x) = \frac{1}{f(x)}\frac{df(x)}{dx}$ を用いると：

$$\frac{\partial \ln Z_N}{\partial \beta} = \frac{1}{Z_N}\frac{\partial Z_N}{\partial \beta}$$

したがって：

$$\langle E \rangle = -\frac{\partial \ln Z_N}{\partial \beta}$$

これで式(13)が示されました。

**物理的意味:**
- 分配関数の対数を $\beta$（逆温度）で微分することで、系の平均エネルギーが得られます
- これは統計力学における重要な関係式であり、分配関数からすべての熱力学量を導出できることを示しています

---

### 問2: N=1の場合の分配関数 $Z_1$ の計算

**問題:** 振動子がひとつ、つまり $N=1$ の場合の、$Z_1$ を計算せよ。

**解答:**

$N=1$ の場合、分配関数は：

$$Z_1 = \sum_{m=0}^\infty e^{-\beta E_m}$$

ここで、$E_m = \hbar\omega(m + 1/2)$ より：

$$Z_1 = \sum_{m=0}^\infty e^{-\beta \hbar\omega(m + 1/2)} = e^{-\beta \hbar\omega/2} \sum_{m=0}^\infty e^{-\beta \hbar\omega m}$$

$\sum_{m=0}^\infty e^{-\beta \hbar\omega m}$ は初項 $1$、公比 $r = e^{-\beta \hbar\omega}$ の等比級数です。

$|r| = e^{-\beta \hbar\omega} < 1$（$\beta > 0$, $\hbar\omega > 0$）のとき、この級数は収束し：

$$\sum_{m=0}^\infty e^{-\beta \hbar\omega m} = \sum_{m=0}^\infty (e^{-\beta \hbar\omega})^m = \frac{1}{1 - e^{-\beta \hbar\omega}}$$

したがって：

$$Z_1 = e^{-\beta \hbar\omega/2} \cdot \frac{1}{1 - e^{-\beta \hbar\omega}} = \frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}$$

**別の表現:**

分子と分母に $e^{\beta \hbar\omega/2}$ を掛けると：

$$Z_1 = \frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}} = \frac{1}{e^{\beta \hbar\omega/2} - e^{-\beta \hbar\omega/2}} = \frac{1}{2\sinh(\beta \hbar\omega/2)}$$

ここで、$\sinh x = \frac{e^x - e^{-x}}{2}$ を用いました。

**物理的意味:**
- $Z_1$ は1つの調和振動子の分配関数であり、すべての可能な量子状態のボルツマン因子の和です
- 零点エネルギー項 $e^{-\beta \hbar\omega/2}$ と励起状態の寄与 $\frac{1}{1 - e^{-\beta \hbar\omega}}$ に分離できます

---

### 問3: N=1の場合の平均エネルギー $\langle E \rangle$ の計算

**問題:** $N = 1$ の場合の、$\langle E \rangle$ を計算せよ。

**解答:**

問1で示した式(13)を用います：

$$\langle E \rangle = -\frac{\partial \ln Z_1}{\partial \beta}$$

問2の結果より：

$$Z_1 = \frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}$$

対数を取ると：

$$\ln Z_1 = -\frac{\beta \hbar\omega}{2} - \ln(1 - e^{-\beta \hbar\omega})$$

これを $\beta$ で微分：

$$\frac{\partial \ln Z_1}{\partial \beta} = -\frac{\hbar\omega}{2} - \frac{\partial}{\partial \beta}\ln(1 - e^{-\beta \hbar\omega})$$

第二項を計算：

$$\frac{\partial}{\partial \beta}\ln(1 - e^{-\beta \hbar\omega}) = \frac{1}{1 - e^{-\beta \hbar\omega}} \cdot \frac{\partial}{\partial \beta}(1 - e^{-\beta \hbar\omega})$$

$$= \frac{1}{1 - e^{-\beta \hbar\omega}} \cdot \hbar\omega e^{-\beta \hbar\omega} = \frac{\hbar\omega e^{-\beta \hbar\omega}}{1 - e^{-\beta \hbar\omega}}$$

したがって：

$$\frac{\partial \ln Z_1}{\partial \beta} = -\frac{\hbar\omega}{2} - \frac{\hbar\omega e^{-\beta \hbar\omega}}{1 - e^{-\beta \hbar\omega}}$$

$$= -\frac{\hbar\omega}{2} - \frac{\hbar\omega}{e^{\beta \hbar\omega} - 1}$$

平均エネルギーは：

$$\langle E \rangle = -\frac{\partial \ln Z_1}{\partial \beta} = \frac{\hbar\omega}{2} + \frac{\hbar\omega}{e^{\beta \hbar\omega} - 1}$$

$$= \hbar\omega\left(\frac{1}{2} + \frac{1}{e^{\beta \hbar\omega} - 1}\right)$$

**物理的解釈:**
- 第一項 $\frac{\hbar\omega}{2}$: 零点エネルギー（温度に依存しない）
- 第二項 $\frac{\hbar\omega}{e^{\beta \hbar\omega} - 1}$: 熱励起によるエネルギー（温度に依存）
- 低温では第二項は0に近づき、$\langle E \rangle \approx \frac{\hbar\omega}{2}$（零点エネルギーのみ）
- 高温では第二項は $\hbar\omega/(\beta \hbar\omega) = k_B T$ に近づき、$\langle E \rangle \approx k_B T$（等分配則）

---

### 問4: 一般のNの場合の分配関数 $Z_N$ の計算（第1の方法）

**問題:** 一般の $N$ の場合の $Z_N$ を計算しよう。この計算には2通りの方法がある。第1の方法は、状態 $i$ を振動子ごとに数える方法である。分配関数は

**式(14):**
$$Z_N = \sum_i e^{-\beta E_i} = \sum_{m_1, m_2, \ldots, m_N} e^{-\beta \hbar\omega(m_1+m_2+\cdots+m_N+N/2)} = \left\{e^{-\beta \hbar\omega/2} \sum_{m=0}^\infty e^{-\beta \hbar\omega m}\right\}^N \tag{14}$$

と書ける。この和を実行して、$Z_N$ を導け。

**解答:**

式(14)の右辺を詳しく見ると：

$$Z_N = \sum_{m_1=0}^\infty \sum_{m_2=0}^\infty \cdots \sum_{m_N=0}^\infty e^{-\beta \hbar\omega(m_1+m_2+\cdots+m_N+N/2)}$$

$$= e^{-\beta \hbar\omega N/2} \sum_{m_1=0}^\infty \sum_{m_2=0}^\infty \cdots \sum_{m_N=0}^\infty e^{-\beta \hbar\omega(m_1 + m_2 + \cdots + m_N)}$$

各振動子が独立であるため、多重和は因数分解できます：

$$Z_N = e^{-\beta \hbar\omega N/2} \left(\sum_{m_1=0}^\infty e^{-\beta \hbar\omega m_1}\right) \left(\sum_{m_2=0}^\infty e^{-\beta \hbar\omega m_2}\right) \cdots \left(\sum_{m_N=0}^\infty e^{-\beta \hbar\omega m_N}\right)$$

各和は同じ形なので：

$$Z_N = e^{-\beta \hbar\omega N/2} \left(\sum_{m=0}^\infty e^{-\beta \hbar\omega m}\right)^N$$

問2と同様に、等比級数の和を計算：

$$\sum_{m=0}^\infty e^{-\beta \hbar\omega m} = \frac{1}{1 - e^{-\beta \hbar\omega}}$$

したがって：

$$Z_N = e^{-\beta \hbar\omega N/2} \left(\frac{1}{1 - e^{-\beta \hbar\omega}}\right)^N = \left(\frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}\right)^N$$

問2の結果 $Z_1 = \frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}$ を用いると：

$$Z_N = (Z_1)^N$$

**物理的意味:**
- 独立な $N$ 個の振動子の分配関数は、1つの振動子の分配関数の $N$ 乗になります
- これは、独立な系の分配関数が各系の分配関数の積になることを示しています

---

### 問5: 状態数 $W_N(M)$ の計算（第2の方法）

**問題:** もう一つの方法は、エネルギー $E$ を指定するごとに、そのエネルギーをもつ状態数を数え上げておき、そのあとでエネルギーに対して和をとる方法である。

**式(15):**
$$Z_N = \sum_i e^{-\beta E_i} = \sum_{M=0}^\infty W_N(M) e^{-\beta \hbar\omega(M+N/2)} \tag{15}$$

$W_N(M)$ は、エネルギー $E = \hbar\omega(M + N/2)$ における状態数である。$W_N(M)$ を求めよ。ヒント: 講義で紹介した、$(N-1)$ 個の黒丸と $M$ 個の白丸を並べる方法を使えばよい。

**解答:**

$W_N(M)$ は、$N$ 個の振動子の量子数の和が $M$ になるような状態の数です。すなわち：

$$m_1 + m_2 + \cdots + m_N = M$$

を満たす非負整数の組 $(m_1, m_2, \ldots, m_N)$ の個数を求めます。

**組合せ論による解法:**

この問題は、「$M$ 個の区別できないボールを $N$ 個の区別できる箱に分配する方法の数」と同じです。

ヒントに従い、$(N-1)$ 個の仕切り（黒丸）と $M$ 個のボール（白丸）を一列に並べる方法を考えます。

例: $N=3$, $M=4$ の場合
- 仕切りを $|$、ボールを $\circ$ で表すと
- $| \circ \circ | \circ \circ$ は $(m_1=0, m_2=2, m_3=2)$ を表す
- $\circ | \circ \circ \circ |$ は $(m_1=1, m_2=3, m_3=0)$ を表す

一般に、$(N-1)$ 個の仕切りと $M$ 個のボールを並べる方法の数は：

$$W_N(M) = \frac{(N-1+M)!}{(N-1)!M!} = \binom{N-1+M}{M} = \binom{N-1+M}{N-1}$$

これは、$(N-1+M)$ 個の位置から $(N-1)$ 個の仕切りの位置を選ぶ組合せの数です。

**別の導出方法:**

$m_1 + m_2 + \cdots + m_N = M$ を満たす非負整数解の個数は、重複組合せ（combination with repetition）を用いて：

$$W_N(M) = \binom{N+M-1}{M} = \binom{N+M-1}{N-1}$$

**具体例:**

- $N=1$: $W_1(M) = \binom{M}{M} = 1$（1つの状態のみ）
- $N=2$: $W_2(M) = \binom{M+1}{M} = M+1$
- $N=3$: $W_3(M) = \binom{M+2}{M} = \frac{(M+2)(M+1)}{2}$

**物理的意味:**
- $W_N(M)$ は、全量子数の和が $M$ であるような状態の縮退度（degeneracy）を表します
- 同じエネルギー $E = \hbar\omega(M + N/2)$ を持つ状態が $W_N(M)$ 個存在します

---

### 問6: 第2の方法による $Z_N$ の計算と一致の確認

**問題:** 式(15)の和を実行して $Z_N$ を計算し、問4の $Z_N$ と一致することを確かめよ。ヒント: $(1-x)^{-N}$ を $x=0$ 周辺でテイラー展開したときの係数を求めよ。

**解答:**

式(15)より：

$$Z_N = \sum_{M=0}^\infty W_N(M) e^{-\beta \hbar\omega(M+N/2)}$$

$$= e^{-\beta \hbar\omega N/2} \sum_{M=0}^\infty W_N(M) e^{-\beta \hbar\omega M}$$

問5の結果 $W_N(M) = \binom{N+M-1}{M}$ を代入：

$$Z_N = e^{-\beta \hbar\omega N/2} \sum_{M=0}^\infty \binom{N+M-1}{M} e^{-\beta \hbar\omega M}$$

$x = e^{-\beta \hbar\omega}$ とおくと：

$$Z_N = e^{-\beta \hbar\omega N/2} \sum_{M=0}^\infty \binom{N+M-1}{M} x^M$$

**テイラー展開の利用:**

ヒントに従い、$(1-x)^{-N}$ を $x=0$ 周辺でテイラー展開します。

一般化二項定理より：

$$(1-x)^{-N} = \sum_{M=0}^\infty \binom{N+M-1}{M} x^M$$

ただし、$|x| < 1$ のとき収束します。

したがって：

一般化二項定理（負の二項展開）より、$|x| < 1$ のとき：

$$(1-x)^{-N} = \sum_{M=0}^\infty \binom{N+M-1}{M} x^M = \sum_{M=0}^\infty \binom{N+M-1}{N-1} x^M$$

これは、$(1-x)^{-N}$ のテイラー展開（または二項展開）として導出できます。

**導出の補足:**

$(1-x)^{-N}$ のテイラー展開は：

$$(1-x)^{-N} = \sum_{M=0}^\infty \frac{(-N)(-N-1)\cdots(-N-M+1)}{M!} (-x)^M$$

$$= \sum_{M=0}^\infty \frac{(-1)^M N(N+1)\cdots(N+M-1)}{M!} (-x)^M$$

$$= \sum_{M=0}^\infty \frac{N(N+1)\cdots(N+M-1)}{M!} x^M$$

$$= \sum_{M=0}^\infty \frac{(N+M-1)!}{(N-1)! M!} x^M = \sum_{M=0}^\infty \binom{N+M-1}{M} x^M$$

したがって：

$$\sum_{M=0}^\infty \binom{N+M-1}{M} x^M = (1-x)^{-N}$$

$x = e^{-\beta \hbar\omega}$ を代入：

$$Z_N = e^{-\beta \hbar\omega N/2} (1 - e^{-\beta \hbar\omega})^{-N}$$

$$= \left(\frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}\right)^N$$

これは問4で得られた結果と完全に一致します。

**一致の確認:**

問4の結果: $Z_N = \left(\frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}\right)^N$

問6の結果: $Z_N = \left(\frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}\right)^N$

**物理的意味:**
- 第1の方法（振動子ごとに状態を数える）と第2の方法（エネルギーごとに状態数を数える）は、数学的に等価です
- 第2の方法では、縮退度 $W_N(M)$ を明示的に考慮することで、同じ結果が得られます
- これは、統計力学における異なる計算手法の一貫性を示しています

---

### 問7: 平均エネルギー $\langle E \rangle$ の計算

**問題:** 問4、5で計算した $Z_N$ を用いて、エネルギーの平均値 $\langle E \rangle$ を計算せよ。

**解答:**

問1で示した式(13)を用います：

$$\langle E \rangle = -\frac{\partial \ln Z_N}{\partial \beta}$$

問4の結果より：

$$Z_N = \left(\frac{e^{-\beta \hbar\omega/2}}{1 - e^{-\beta \hbar\omega}}\right)^N$$

対数を取ると：

$$\ln Z_N = N\left[\ln\left(e^{-\beta \hbar\omega/2}\right) - \ln(1 - e^{-\beta \hbar\omega})\right]$$

$$= N\left[-\frac{\beta \hbar\omega}{2} - \ln(1 - e^{-\beta \hbar\omega})\right]$$

これを $\beta$ で微分：

$$\frac{\partial \ln Z_N}{\partial \beta} = N\left[-\frac{\hbar\omega}{2} - \frac{\partial}{\partial \beta}\ln(1 - e^{-\beta \hbar\omega})\right]$$

第二項を計算：

$$\frac{\partial}{\partial \beta}\ln(1 - e^{-\beta \hbar\omega}) = \frac{1}{1 - e^{-\beta \hbar\omega}} \cdot \frac{\partial}{\partial \beta}(1 - e^{-\beta \hbar\omega})$$

$$= \frac{1}{1 - e^{-\beta \hbar\omega}} \cdot \hbar\omega e^{-\beta \hbar\omega} = \frac{\hbar\omega e^{-\beta \hbar\omega}}{1 - e^{-\beta \hbar\omega}}$$

$$= \frac{\hbar\omega}{e^{\beta \hbar\omega} - 1}$$

したがって：

$$\frac{\partial \ln Z_N}{\partial \beta} = N\left[-\frac{\hbar\omega}{2} - \frac{\hbar\omega}{e^{\beta \hbar\omega} - 1}\right]$$

$$= -N\hbar\omega\left[\frac{1}{2} + \frac{1}{e^{\beta \hbar\omega} - 1}\right]$$

平均エネルギーは：

$$\langle E \rangle = -\frac{\partial \ln Z_N}{\partial \beta} = N\hbar\omega\left[\frac{1}{2} + \frac{1}{e^{\beta \hbar\omega} - 1}\right]$$

**物理的解釈:**

1. **零点エネルギー項**: $\frac{N}{2}\hbar\omega$
   - 温度に依存しない
   - $N$ 個の振動子それぞれが零点エネルギー $\frac{1}{2}\hbar\omega$ を持つ

2. **熱励起エネルギー項**: $\frac{N\hbar\omega}{e^{\beta \hbar\omega} - 1}$
   - 温度に依存する
   - プランク分布の形をしている

**温度依存性:**

- **低温極限** ($T \to 0$, $\beta \to \infty$):
  $$e^{\beta \hbar\omega} \to \infty$$
  $$\langle E \rangle \approx N\hbar\omega\left[\frac{1}{2} + 0\right] = \frac{N}{2}\hbar\omega$$
  零点エネルギーのみが残ります。

- **高温極限** ($T \to \infty$, $\beta \to 0$):
  $$e^{\beta \hbar\omega} \approx 1 + \beta \hbar\omega$$
  $$\frac{1}{e^{\beta \hbar\omega} - 1} \approx \frac{1}{\beta \hbar\omega} = \frac{k_B T}{\hbar\omega}$$
  $$\langle E \rangle \approx N\hbar\omega\left[\frac{1}{2} + \frac{k_B T}{\hbar\omega}\right] = \frac{N}{2}\hbar\omega + Nk_B T$$
  高温では、第二項が支配的になり、$\langle E \rangle \approx Nk_B T$（等分配則）に近づきます。

**問3との関係:**

問3の結果（$N=1$）を $N$ 倍すると、問7の結果と一致します。これは、独立な振動子の平均エネルギーが各振動子の平均エネルギーの和になることを示しています。

---

# IV. 古典理想気体

## 問題の概要

古典理想気体は、$N$ 個の単原子分子からなる系で、各分子は互いに相互作用せず、それぞれが自由に運動します。この系の統計力学的性質を解析します。

熱力学におけるエントロピーとヘルムホルツの自由エネルギーは、以下で与えられます：

**式(16):**
$$S(E, V, N) = N k_B \ln\left\{\left(\frac{E}{c N k_B}\right)^c \frac{V}{N}\right\} + N s_0 \tag{16}$$

$$F(T, V, N) = c N k_B T - N k_B T \ln\left(\frac{T^c V}{N}\right) - N T s_0$$

ここで、$c = 3/2$（単原子分子の場合）、$k_B = R/N_A$（$R$ は気体定数、$N_A$ はアボガドロ数）、$s_0$ は熱力学的変数に依存しない定数です。

---

## 問1: 分配関数の計算（第1の方法）

**問題:** 古典理想気体の分配関数は、

**式(17):**
$$Z_N = \frac{1}{N! h^{3N}} \int d\Gamma \, \exp[-\beta H] \tag{17}$$

ここで、$d\Gamma = dr_{1x} dp_{1x} dr_{1y} dp_{1y} \cdots dr_{Nz} dp_{Nz}$ は $3N$ 次元位相空間の微小体積要素、$h$ は (座標) × (運動量) の次元を持つ定数で、量子系と比較するとプランク定数に相当します。$N!$ は、原子の区別不能性のために必要な因子です。

ハミルトニアンは、

**式(18):**
$$H = \sum_{l=1}^N \sum_{\alpha=x,y,z} \frac{p_{l,\alpha}^2}{2m} \tag{18}$$

式(17)を計算する方法は2通りある。第1の方法は、各自由度ごとに積分する方法である。

**式(19):**
$$Z_N = \frac{1}{N!} \left(\frac{1}{h}\right)^{3N} \left[\int_0^L dr \int_{-\infty}^{\infty} dp \, \exp\left[-\beta \frac{p_x^2}{2m}\right]\right]^{3N} \tag{19}$$

ここで、$L$ は体積 $V$ の容器の一辺の長さである。この積分を実行して $Z_N$ を求めよ。また、問1の結果を用いて、$\ln\Gamma(x) \approx x\ln x - x$（$x \gg 1$ のとき）を用いて $F = -k_B T \ln Z_N$ を計算し、式(16)の $F$ と一致することを確かめよ。また、$s_0$ の具体的な表式を求めよ。

**解答:**

**積分の実行:**

各自由度について、位置と運動量の積分を実行します。

**位置積分:**
$$\int_0^L dr = L$$

**運動量積分:**
$$\int_{-\infty}^{\infty} dp \, \exp\left[-\beta \frac{p_x^2}{2m}\right]$$

ガウス積分の公式 $\int_{-\infty}^{\infty} dx \, e^{-ax^2} = \sqrt{\frac{\pi}{a}}$ を用いると：

$$\int_{-\infty}^{\infty} dp \, \exp\left[-\beta \frac{p_x^2}{2m}\right] = \sqrt{\frac{2\pi m}{\beta}} = \sqrt{2\pi m k_B T}$$

したがって、1つの自由度について：

$$\int_0^L dr \int_{-\infty}^{\infty} dp \, \exp\left[-\beta \frac{p_x^2}{2m}\right] = L \sqrt{2\pi m k_B T}$$

$L^3 = V$ より、$3N$ 個の自由度について：

$$\left[\int_0^L dr \int_{-\infty}^{\infty} dp \, \exp\left[-\beta \frac{p_x^2}{2m}\right]\right]^{3N} = (L \sqrt{2\pi m k_B T})^{3N} = V^N (2\pi m k_B T)^{3N/2}$$

**分配関数:**

$$Z_N = \frac{1}{N!} \left(\frac{1}{h}\right)^{3N} V^N (2\pi m k_B T)^{3N/2}$$

$$= \frac{V^N}{N!} \left(\frac{2\pi m k_B T}{h^2}\right)^{3N/2}$$

**自由エネルギー:**

$$F = -k_B T \ln Z_N = -k_B T \left[N\ln V - \ln N! + \frac{3N}{2}\ln\left(\frac{2\pi m k_B T}{h^2}\right)\right]$$

スターリングの公式 $\ln N! \approx N\ln N - N$ を用いると：

$$F = -k_B T \left[N\ln V - (N\ln N - N) + \frac{3N}{2}\ln\left(\frac{2\pi m k_B T}{h^2}\right)\right]$$

$$= -N k_B T \ln V + N k_B T \ln N - N k_B T - \frac{3N}{2} k_B T \ln\left(\frac{2\pi m k_B T}{h^2}\right)$$

$$= N k_B T \ln\left(\frac{N}{V}\right) - N k_B T - \frac{3N}{2} k_B T \ln\left(\frac{2\pi m k_B T}{h^2}\right)$$

$$= N k_B T \ln\left(\frac{N}{V}\right) - N k_B T - \frac{3N}{2} k_B T \ln T - \frac{3N}{2} k_B T \ln\left(\frac{2\pi m k_B}{h^2}\right)$$

式(16)の形式 $F(T, V, N) = c N k_B T - N k_B T \ln\left(\frac{T^c V}{N}\right) - N T s_0$（$c = 3/2$）に合わせて整理します。

まず、$\ln\left(\frac{N}{V}\right) = -\ln\left(\frac{V}{N}\right)$ より：

$$F = -N k_B T \ln\left(\frac{V}{N}\right) - N k_B T - \frac{3N}{2} k_B T \ln T - \frac{3N}{2} k_B T \ln\left(\frac{2\pi m k_B}{h^2}\right)$$

$T$ の項をまとめます：

$$F = -N k_B T \ln\left(\frac{V}{N}\right) - \frac{3N}{2} k_B T \ln T - N k_B T\left[1 + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$$

式(16)の形式に合わせるため、$\ln\left(\frac{T^{3/2} V}{N}\right) = \frac{3}{2}\ln T + \ln\left(\frac{V}{N}\right)$ を用います：

$$F = -N k_B T\left[\ln\left(\frac{V}{N}\right) + \frac{3}{2}\ln T\right] - N k_B T\left[1 + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$$

$$= -N k_B T \ln\left(\frac{T^{3/2} V}{N}\right) - N k_B T\left[1 + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$$

式(16)と比較するため、$c N k_B T = \frac{3N}{2} k_B T$ の項を追加・減算：

$$F = \frac{3N}{2} k_B T - \frac{3N}{2} k_B T - N k_B T \ln\left(\frac{T^{3/2} V}{N}\right) - N k_B T\left[1 + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$$

$$= \frac{3N}{2} k_B T - N k_B T \ln\left(\frac{T^{3/2} V}{N}\right) - N k_B T\left[1 + \frac{3}{2} + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$$

$$= \frac{3N}{2} k_B T - N k_B T \ln\left(\frac{T^{3/2} V}{N}\right) - N k_B T\left[\frac{5}{2} + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$$

式(16)と比較すると：

$$F(T, V, N) = \frac{3N}{2} k_B T - N k_B T \ln\left(\frac{T^{3/2} V}{N}\right) - N T s_0$$

したがって：

$$s_0 = k_B\left[\frac{5}{2} + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$$

**注意:** $s_0$ は $N$ に依存しない定数であることに注意してください。

**物理的意味:**
- 分配関数から、自由エネルギーやエントロピーなどの熱力学量が導出されます
- $N!$ 因子は、粒子の区別不能性により、位相空間の体積を正しく規格化するために必要です

---

## 問2: 平均エネルギー $\langle E \rangle$ の計算

**問題:** 理想気体の平均エネルギー $\langle E \rangle$ を計算せよ。

**解答:**

問1で示した式(13)を用います：

$$\langle E \rangle = -\frac{\partial \ln Z_N}{\partial \beta}$$

分配関数 $Z_N = \frac{V^N}{N!} \left(\frac{2\pi m k_B T}{h^2}\right)^{3N/2}$ より：

$$\ln Z_N = N\ln V - \ln N! + \frac{3N}{2}\ln(2\pi m) - \frac{3N}{2}\ln h^2 + \frac{3N}{2}\ln(k_B T)$$

$$= N\ln V - \ln N! + \frac{3N}{2}\ln(2\pi m) - \frac{3N}{2}\ln h^2 - \frac{3N}{2}\ln\beta$$

$\beta$ で微分：

$$\frac{\partial \ln Z_N}{\partial \beta} = -\frac{3N}{2\beta}$$

したがって：

$$\langle E \rangle = -\frac{\partial \ln Z_N}{\partial \beta} = \frac{3N}{2\beta} = \frac{3N}{2} k_B T$$

**物理的意味:**
- 平均エネルギーは $\frac{3}{2}N k_B T$ となり、等分配則（equipartition theorem）を満たします
- 各自由度（3次元空間の各方向）に対して $\frac{1}{2}k_B T$ のエネルギーが分配されます

---

## 問3: 分配関数の計算（第2の方法）

**問題:** 式(17)を計算するもう一つの方法は、一定エネルギー面上の状態数を数えてから、エネルギーで積分する方法である。式(17)を極座標で書くと

**式(20):**
$$Z_N = \frac{V^N}{N! h^{3N}} \int_0^{\infty} dp \, C_{3N} p^{3N-1} \exp\left[-\beta \frac{p^2}{2m}\right] \tag{20}$$

となることを確かめよ。ここで、$C_{3N}$ は問題IIで登場した球の表面積の係数であり、$p^2 = \sum_{l=1}^N \sum_{\alpha=x,y,z} p_{l,\alpha}^2$ である。

**解答:**

運動量空間において、$3N$ 次元の極座標を導入します。運動量ベクトルを $\vec{p} = (p_{1x}, p_{1y}, p_{1z}, \ldots, p_{Nx}, p_{Ny}, p_{Nz})$ とすると、$p = |\vec{p}|$ とします。

ハミルトニアンは $p$ のみの関数：

$$H = \sum_{l=1}^N \sum_{\alpha=x,y,z} \frac{p_{l,\alpha}^2}{2m} = \frac{p^2}{2m}$$

運動量空間での積分を、極座標に変換します。$3N$ 次元球の表面積は $C_{3N} p^{3N-1}$ で与えられます（問題IIの結果）。

したがって：

$$Z_N = \frac{1}{N! h^{3N}} \int d\Gamma \, \exp[-\beta H]$$

位置積分は独立に実行でき、$V^N$ を与えます：

$$Z_N = \frac{V^N}{N! h^{3N}} \int d^{3N}p \, \exp\left[-\beta \frac{p^2}{2m}\right]$$

運動量積分を極座標に変換：

$$Z_N = \frac{V^N}{N! h^{3N}} \int_0^{\infty} dp \, C_{3N} p^{3N-1} \exp\left[-\beta \frac{p^2}{2m}\right]$$

これで式(20)が得られました。

**物理的意味:**
- 第2の方法では、エネルギー面で状態数を数えることで、統計力学的な意味がより明確になります
- この方法は、後で状態数密度 $W_N(E)$ を定義するのに便利です

---

## 問4: 状態数密度 $W_N(E)$ の計算

**問題:** 式(20)において、変数変換 $p = \sqrt{2mE}$ を行うと、

**式(21):**
$$Z_N = \int_0^{\infty} dE \, W_N(E) e^{-\beta E} \tag{21}$$

となる。$W_N(E)$ を求めよ。

**解答:**

変数変換 $p = \sqrt{2mE}$ を行うと：

$$dp = \frac{dp}{dE} dE = \frac{\sqrt{2m}}{2\sqrt{E}} dE = \sqrt{\frac{m}{2E}} dE$$

また、$p^2 = 2mE$ より：

$$p^{3N-1} = (2mE)^{(3N-1)/2} = (2m)^{(3N-1)/2} E^{(3N-1)/2}$$

式(20)に代入：

$$Z_N = \frac{V^N}{N! h^{3N}} \int_0^{\infty} dE \, C_{3N} (2mE)^{(3N-1)/2} \sqrt{\frac{m}{2E}} \exp[-\beta E]$$

$$= \frac{V^N}{N! h^{3N}} \int_0^{\infty} dE \, C_{3N} (2m)^{(3N-1)/2} E^{(3N-1)/2} \sqrt{\frac{m}{2E}} \exp[-\beta E]$$

**指数の計算:**

$E^{(3N-1)/2}$ と $\sqrt{\frac{m}{2E}} = \left(\frac{m}{2E}\right)^{1/2} = E^{-1/2} \sqrt{\frac{m}{2}}$ の積：

$$E^{(3N-1)/2} \cdot E^{-1/2} = E^{(3N-1-1)/2} = E^{(3N-2)/2}$$

したがって：

$$= \frac{V^N}{N! h^{3N}} \int_0^{\infty} dE \, C_{3N} (2m)^{(3N-1)/2} \sqrt{\frac{m}{2}} E^{(3N-2)/2} \exp[-\beta E]$$

$$= \frac{V^N}{N! h^{3N}} \int_0^{\infty} dE \, C_{3N} (2m)^{3N/2} \frac{1}{2} E^{(3N-2)/2} \exp[-\beta E]$$

$$= \frac{V^N}{N! h^{3N}} \int_0^{\infty} dE \, \frac{C_{3N}}{2} (2m)^{3N/2} E^{(3N-2)/2} \exp[-\beta E]$$

問題IIの結果より、$C_{3N} = \frac{2\pi^{3N/2}}{\Gamma(3N/2)}$ を代入：

$$W_N(E) = \frac{V^N}{N! h^{3N}} \cdot \frac{C_{3N}}{2} (2m)^{3N/2} E^{(3N-2)/2}$$

$$= \frac{V^N}{N! h^{3N}} \cdot \frac{1}{2} \cdot \frac{2\pi^{3N/2}}{\Gamma(3N/2)} (2m)^{3N/2} E^{(3N-2)/2}$$

$$= \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} E^{(3N-2)/2}$$

**物理的意味:**
- $W_N(E)$ は、エネルギー $E$ から $E + dE$ の間にある微視的状態の数（状態数密度）を表します
- この量は、エントロピーの定義 $S = k_B \ln W$ において重要です
- エネルギー $E$ での状態数密度は $E^{(3N-2)/2} \propto E^{3N/2}$ に比例し、エネルギーの増加とともに急激に増加します
- これは、高エネルギー状態ほど多くの微視的状態が存在することを意味します

---

## 問5: エントロピーの一致

**問題:** 問4で求めた $W_N(E)$ の対数 $S = k_B \ln W_N(E)$ が、式(16)のエントロピーと一致することを示せ。$\ln\Gamma(x) \approx x\ln x - x$（$x \gg 1$ のとき）を用いよ。また、$s_0$ の具体的な表式を求めよ。

**解答:**

$$S = k_B \ln W_N(E) = k_B \ln\left[\frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} E^{(3N-2)/2}\right]$$

$$= k_B \left[N\ln V + \frac{3N}{2}\ln(2\pi m) - \ln N! - 3N\ln h - \ln\Gamma(3N/2) + \frac{3N-2}{2}\ln E\right]$$

大きな $N$ に対して、スターリングの公式と $\ln\Gamma(x) \approx x\ln x - x$ を用います：

$$\ln N! \approx N\ln N - N$$

$\ln\Gamma(x) \approx x\ln x - x$（$x \gg 1$）を用いると：

$$\ln\Gamma(3N/2) \approx \frac{3N}{2}\ln\left(\frac{3N}{2}\right) - \frac{3N}{2}$$

$$= \frac{3N}{2}\left[\ln(3N) - \ln 2\right] - \frac{3N}{2}$$

$$= \frac{3N}{2}\ln(3N) - \frac{3N}{2}\ln 2 - \frac{3N}{2}$$

$$= \frac{3N}{2}\ln N + \frac{3N}{2}\ln 3 - \frac{3N}{2}\ln 2 - \frac{3N}{2}$$

**注意:** この近似では、$\ln\Gamma(x) \approx x\ln x - x$ が使われていますが、より正確には $\ln\Gamma(x) \approx (x-1/2)\ln x - x + \frac{1}{2}\ln(2\pi)$ です。しかし、問題の指示に従い、ここでは $\ln\Gamma(x) \approx x\ln x - x$ を用います。

また、$\frac{3N-2}{2} = \frac{3N}{2} - 1$ ですが、対数を取る際の相対誤差は $O(1/N)$ のオーダーなので、大きな $N$ に対して：

$$\frac{3N-2}{2}\ln E \approx \frac{3N}{2}\ln E$$

この近似による相対誤差は $O(1/N)$ であり、$N \gg 1$ で無視できます。

$$S \approx k_B \left[N\ln V + \frac{3N}{2}\ln(2\pi m) - (N\ln N - N) - 3N\ln h\right.$$

$$\left. - \left(\frac{3N}{2}\ln N + \frac{3N}{2}\ln 3 - \frac{3N}{2}\ln 2 - \frac{3N}{2}\right) + \frac{3N}{2}\ln E\right]$$

$$= k_B \left[N\ln V - N\ln N + N + \frac{3N}{2}\ln(2\pi m) - 3N\ln h\right.$$

$$\left. - \frac{3N}{2}\ln N - \frac{3N}{2}\ln 3 + \frac{3N}{2}\ln 2 + \frac{3N}{2} + \frac{3N}{2}\ln E\right]$$

$$= k_B N \ln\left(\frac{V}{N}\right) + k_B N + \frac{3k_B N}{2}\ln(2\pi m) - 3k_B N\ln h$$

$$+ \frac{3k_B N}{2}\ln 2 + \frac{3k_B N}{2} - \frac{3k_B N}{2}\ln N + \frac{3k_B N}{2}\ln E$$

$$= k_B N \ln\left(\frac{V}{N}\right) + \frac{3k_B N}{2}\ln E - \frac{3k_B N}{2}\ln N + k_B N\left(1 + \frac{3}{2}\ln(2\pi m) - 3\ln h + \frac{3}{2}\ln 2 + \frac{3}{2}\right)$$

$c = 3/2$ を用いて、式(16)の形式に合わせて整理します。

式(16)の形式は：

$$S(E, V, N) = N k_B \ln\left\{\left(\frac{E}{c N k_B}\right)^c \frac{V}{N}\right\} + N s_0$$

ここで、$c = 3/2$ より：

$$S = N k_B \ln\left\{\left(\frac{E}{\frac{3}{2}N k_B}\right)^{3/2} \frac{V}{N}\right\} + N s_0$$

$$= N k_B \left[\frac{3}{2}\ln\left(\frac{E}{\frac{3}{2}N k_B}\right) + \ln\left(\frac{V}{N}\right)\right] + N s_0$$

$$= N k_B \ln\left(\frac{V}{N}\right) + \frac{3N k_B}{2}\ln\left(\frac{E}{\frac{3}{2}N k_B}\right) + N s_0$$

上記の計算結果と比較するため、$E$ の項を変形：

$$\frac{3k_B N}{2}\ln E = \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right) + \frac{3k_B N}{2}\ln\left(\frac{3N k_B}{2}\right)$$

$$= \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right) + \frac{3k_B N}{2}\ln N + \frac{3k_B N}{2}\ln\left(\frac{3k_B}{2}\right)$$

したがって、$-\frac{3k_B N}{2}\ln N$ の項と組み合わせると：

$$\frac{3k_B N}{2}\ln E - \frac{3k_B N}{2}\ln N = \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right) + \frac{3k_B N}{2}\ln\left(\frac{3k_B}{2}\right)$$

したがって、$S$ を整理すると：

$$S = k_B N \ln\left(\frac{V}{N}\right) + \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right) + \frac{3k_B N}{2}\ln\left(\frac{3k_B}{2}\right) + k_B N\left[1 + \frac{3}{2}\ln(2\pi m) - 3\ln h + \frac{3}{2}\ln 2 + \frac{3}{2}\right]$$

式(16)の形式と比較するため、$\ln\left(\frac{3k_B}{2}\right)$ の項を整理します。

まず、$\frac{3k_B N}{2}\ln\left(\frac{3k_B}{2}\right)$ を展開：

$$\frac{3k_B N}{2}\ln\left(\frac{3k_B}{2}\right) = \frac{3k_B N}{2}\ln(3k_B) - \frac{3k_B N}{2}\ln 2$$

$$= \frac{3k_B N}{2}\ln 3 + \frac{3k_B N}{2}\ln k_B - \frac{3k_B N}{2}\ln 2$$

したがって：

$$S = k_B N \ln\left(\frac{V}{N}\right) + \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right) + \frac{3k_B N}{2}\ln 3 + \frac{3k_B N}{2}\ln k_B - \frac{3k_B N}{2}\ln 2$$

$$+ k_B N\left[1 + \frac{3}{2}\ln(2\pi m) - 3\ln h + \frac{3}{2}\ln 2 + \frac{3}{2}\right]$$

$$= k_B N \ln\left(\frac{V}{N}\right) + \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right)$$

$$+ k_B N\left[1 + \frac{3}{2}\ln(2\pi m) - 3\ln h + \frac{3}{2}\ln 2 + \frac{3}{2} + \frac{3}{2}\ln 3 + \frac{3}{2}\ln k_B - \frac{3}{2}\ln 2\right]$$

$\ln 2$ の項が相殺：

$$= k_B N \ln\left(\frac{V}{N}\right) + \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right)$$

$$+ k_B N\left[1 + \frac{3}{2}\ln(2\pi m) - 3\ln h + \frac{3}{2} + \frac{3}{2}\ln 3 + \frac{3}{2}\ln k_B\right]$$

$$= k_B N \ln\left(\frac{V}{N}\right) + \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right)$$

$$+ k_B N\left[\frac{5}{2} + \frac{3}{2}\ln(2\pi m) + \frac{3}{2}\ln 3 + \frac{3}{2}\ln k_B - 3\ln h\right]$$

$$= k_B N \ln\left(\frac{V}{N}\right) + \frac{3k_B N}{2}\ln\left(\frac{E}{\frac{3N k_B}{2}}\right)$$

$$+ k_B N\left[\frac{5}{2} + \frac{3}{2}\ln(6\pi m k_B) - 3\ln h\right]$$

式(16)の形式と比較すると、$s_0$ は：

$$s_0 = k_B\left[\frac{5}{2} + \frac{3}{2}\ln(6\pi m k_B) - 3\ln h\right]$$

**問1との比較:**

問1では $s_0 = k_B\left[\frac{5}{2} + \frac{3}{2}\ln\left(\frac{2\pi m k_B}{h^2}\right)\right]$ が得られました。

問1の結果を展開：

$$s_0 = k_B\left[\frac{5}{2} + \frac{3}{2}\ln(2\pi m k_B) - 3\ln h\right]$$

問5の結果：

$$s_0 = k_B\left[\frac{5}{2} + \frac{3}{2}\ln(6\pi m k_B) - 3\ln h\right]$$

差は $\frac{3}{2}\ln 3$ です。これは、問題の指示に従い $\ln\Gamma(x) \approx x\ln x - x$ という近似（より正確には $\ln\Gamma(x) \approx (x-1/2)\ln x - x + \frac{1}{2}\ln(2\pi)$ を使うべき）を用いたためです。

**補足:** より正確なスターリングの公式 $\ln\Gamma(x) \approx (x-1/2)\ln x - x + \frac{1}{2}\ln(2\pi)$ を用いれば、問1と問5の $s_0$ は一致します。しかし、問題の指示に従い、ここでは $\ln\Gamma(x) \approx x\ln x - x$ を用いた結果を記述します。

**注意:** $s_0$ は $N$ に依存しない定数であることを確認しました。

**物理的意味:**
- 状態数密度から定義されたエントロピー $S = k_B \ln W_N(E)$ は、熱力学のエントロピーと一致します
- これは、統計力学と熱力学の対応関係を示しています
- **ボルツマンの原理**: 微視的な状態数 $W$ と巨視的なエントロピー $S$ の関係 $S = k_B \ln W$ は、統計力学の基礎原理の一つです
- 理想気体の場合、この原理から熱力学的エントロピーが正しく導出されることが確認できました

---

## 問6: ピーク位置 $E^*$ の計算

**問題:** 式(21)の被積分関数 $W_N(E)e^{-\beta E} = e^{-\beta(E-TS)}$ を $E$ の関数としてプロットすると、鋭いピークを持つことがわかる。このピークの位置 $E^*$ を計算せよ。

**解答:**

被積分関数を $f(E) = W_N(E)e^{-\beta E} = e^{-\beta(E-TS)}$ とします。

$S = k_B \ln W_N(E)$ より：

$$f(E) = e^{-\beta E + \ln W_N(E)} = e^{-\beta E + S/k_B}$$

ピーク位置は、$\frac{df}{dE} = 0$ または $\frac{d}{dE}[\ln f(E)] = 0$ で与えられます。

$$\ln f(E) = -\beta E + \frac{S(E)}{k_B}$$

$$= -\beta E + \ln W_N(E)$$

$\frac{d}{dE}[\ln f(E)] = 0$ より：

$$-\beta + \frac{1}{W_N(E)} \frac{dW_N(E)}{dE} = 0$$

または、$S = k_B \ln W_N(E)$ より：

$$\frac{d}{dE}[\ln W_N(E)] = \frac{1}{k_B}\frac{dS}{dE}$$

熱力学的関係式より、カノニカル分布では：

$$\frac{\partial S}{\partial E} = \frac{1}{T} = k_B \beta$$

**この関係式の導出:**

カノニカル分布では、内部エネルギー $E = \langle E_i \rangle$ とエントロピー $S$ の関係は：

$$dE = T dS - p dV + \mu dN$$

体積 $V$ と粒子数 $N$ が一定の場合：

$$\left.\frac{\partial S}{\partial E}\right|_{V,N} = \frac{1}{T}$$

これを用いると：

$$\frac{d}{dE}[\ln f(E)] = -\beta + \frac{1}{k_B}\frac{dS}{dE} = -\beta + \frac{1}{k_B}\frac{1}{T} = -\beta + \beta = 0$$

したがって、$E^*$ は $\frac{\partial S}{\partial E} = \frac{1}{T}$ を満たすエネルギーです。

$S(E, V, N) = N k_B \ln\left\{\left(\frac{E}{c N k_B}\right)^c \frac{V}{N}\right\} + N s_0$（$c = 3/2$）より：

$$\frac{\partial S}{\partial E} = N k_B \cdot \frac{c}{E} = \frac{c N k_B}{E}$$

したがって：

$$\frac{c N k_B}{E^*} = \frac{1}{T} = k_B \beta$$

$$E^* = c N k_B T = \frac{3N k_B T}{2}$$

**物理的意味:**
- ピーク位置 $E^*$ は、カノニカル分布での平均エネルギー $\langle E \rangle = \frac{3N k_B T}{2}$ と一致します
- 被積分関数が鋭いピークを持つことは、エネルギーの揺らぎが小さいことを示しています
- このピークは、統計力学における「鞍点」に相当します

**エネルギーの揺らぎについて:**

大きな $N$ に対して、エネルギーの標準偏差 $\sigma_E$ は：

$$\sigma_E^2 = \langle E^2 \rangle - \langle E \rangle^2 \sim N (k_B T)^2$$

したがって、相対的な揺らぎは：

$$\frac{\sigma_E}{\langle E \rangle} \sim \frac{\sqrt{N} k_B T}{N k_B T} = \frac{1}{\sqrt{N}}$$

$N \sim 10^{23}$ の場合、$\sigma_E / \langle E \rangle \sim 10^{-12}$ となり、極めて小さいです。これが、被積分関数が鋭いピークを持つ理由です。

**鞍点近似の適用:**

大きな $N$ に対して、被積分関数の主要な寄与はピーク付近から来るため、鞍点近似が有効です。これは、統計力学における重要な近似手法です。

**図4: 古典理想気体の状態数密度**

![古典理想気体の状態数密度](statistical_physics_fig7_ideal_gas_density.png)

図では、被積分関数 $W_N(E)e^{-\beta E}$ のエネルギー依存性が示されており、鋭いピークが $E^* = \frac{3N}{2} k_B T$ 付近にあることが確認できます。

---

## 問7: 積分の実行と一致の確認

**問題:** 式(21)の積分を実行し、問1の結果式(19)と一致することを確かめよ。

**解答:**

式(21):

$$Z_N = \int_0^{\infty} dE \, W_N(E) e^{-\beta E}$$

問4の結果より：

$$W_N(E) = \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} E^{(3N-2)/2}$$

したがって：

$$Z_N = \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} \int_0^{\infty} dE \, E^{(3N-2)/2} e^{-\beta E}$$

変数変換 $u = \beta E$ を行うと、$dE = \frac{du}{\beta}$ より：

$$Z_N = \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} \int_0^{\infty} \frac{du}{\beta} \left(\frac{u}{\beta}\right)^{(3N-2)/2} e^{-u}$$

$$= \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} \beta^{-(3N-2)/2} \beta^{-1} \int_0^{\infty} du \, u^{(3N-2)/2} e^{-u}$$

$$= \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} \beta^{-3N/2} \int_0^{\infty} du \, u^{(3N-2)/2} e^{-u}$$

**ガンマ関数による評価:**

$\int_0^{\infty} du \, u^{(3N-2)/2} e^{-u}$ は、ガンマ関数の定義 $\Gamma(z) = \int_0^{\infty} dt \, t^{z-1} e^{-t}$ より：

$$\int_0^{\infty} du \, u^{(3N-2)/2} e^{-u} = \Gamma\left(\frac{3N-2}{2} + 1\right) = \Gamma\left(\frac{3N}{2}\right)$$

**厳密な計算:**

実際には、$\int_0^{\infty} du \, u^{(3N-2)/2} e^{-u} = \Gamma((3N-2)/2 + 1) = \Gamma(3N/2)$ が正確です。

ガンマ関数の性質 $\Gamma(z+1) = z\Gamma(z)$ より：

$$\Gamma\left(\frac{3N-2}{2} + 1\right) = \Gamma\left(\frac{3N}{2}\right)$$

したがって、近似は不要であり、厳密に：

$$\int_0^{\infty} du \, u^{(3N-2)/2} e^{-u} = \Gamma\left(\frac{3N}{2}\right)$$

**注意:** この計算では、$(3N-2)/2 + 1 = 3N/2$ が正確に成り立つため、近似は必要ありません。

したがって：

$$Z_N = \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N} \Gamma(3N/2)} \beta^{-3N/2} \Gamma\left(\frac{3N}{2}\right)$$

$\Gamma(3N/2)$ で約分：

$$= \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N}} \beta^{-3N/2}$$

$$= \frac{V^N (2\pi m)^{3N/2}}{N! h^{3N}} (k_B T)^{3N/2}$$

$$= \frac{V^N}{N!} \left(\frac{2\pi m k_B T}{h^2}\right)^{3N/2}$$

これは、問1で得られた式(19)の結果と完全に一致します。✓

**物理的意味:**
- 第1の方法（各自由度ごとに積分）と第2の方法（エネルギー面で状態数を数える）は、数学的に等価です
- この一致は、統計力学における異なる計算手法の一貫性を示しています

---

## 練習問題

1. $N = 2$ の場合について、分配関数 $Z_2$ を直接計算し、$Z_2 = (Z_1)^2$ であることを確認せよ。

2. 内部エネルギー $E$ の低温極限と高温極限での振る舞いを求め、物理的に解釈せよ。

3. エントロピー $S$ を分配関数から導出せよ。

4. 比熱 $C_V$ の温度依存性をグラフに描き、アインシュタイン温度 $T_E = \hbar\omega/k_B$ の意味を説明せよ。

---

# 物理学的な核心をつく質問と回答

以下、各小問について、統計力学の本質を理解するための深い質問とその回答を提供します。

---

## I. スターリングの公式

### 問1に関する質問

**Q1-1: なぜガンマ関数 $\Gamma(x)$ が階乗 $N!$ の連続化として重要なのか？統計力学において、この連続化がどのような物理的意味を持つか？**

**回答:**

ガンマ関数は階乗の連続化として、以下の理由で重要です：

1. **統計力学における連続極限**: 統計力学では、大きな系（$N \sim 10^{23}$）を扱うため、離散的な階乗を連続的な関数として扱う必要があります。ガンマ関数は、この連続極限への移行を数学的に厳密に定義します。

2. **エントロピーの計算**: エントロピー $S = k_B \ln W$ において、$W$ は状態数であり、多くの場合 $N!$ を含みます。大きな $N$ に対して、$\ln N!$ を計算する際に、ガンマ関数の性質が不可欠です。

3. **相空間の体積**: 古典統計力学では、位相空間の体積を計算する際に、ガンマ関数が現れます。これは、$D$ 次元球の体積公式などに現れ、状態数の計算に直接関係します。

**物理的意味**: ガンマ関数による連続化は、微視的な離散状態から巨視的な連続的な熱力学量への移行を表しています。これは、統計力学の基礎となる「微視的状態の数え上げ」と「巨視的熱力学量の導出」の橋渡しを担っています。

---

**Q1-2: $\Gamma(N+1) = N!$ という関係式は、なぜ統計力学において頻繁に用いられるのか？**

**回答:**

この関係式が頻繁に用いられる理由は以下の通りです：

1. **状態数の計算**: 統計力学では、$N$ 個の粒子の配置の数が $N!$ で与えられます。粒子の区別不能性を考慮する際、この因子が現れます。

2. **分配関数の規格化**: カノニカル分布では、分配関数 $Z_N$ を計算する際、位相空間の体積を正しく規格化するために $N!$ が必要です。これは、量子統計力学との対応を保つためです。

3. **エントロピーの導出**: エントロピー $S = k_B \ln W$ において、$W \propto N!$ となることが多く、スターリングの公式 $\ln N! \approx N\ln N - N$ を用いてエントロピーを計算します。

**物理的意味**: $N!$ 因子は、粒子の区別不能性（indistinguishability）を反映しています。古典統計力学では、この因子により、量子統計力学との整合性が保たれます。

---

### 問3に関する質問

**Q3-1: 鞍点近似（最急降下法）は、なぜ統計力学において有効なのか？物理的には何を意味しているのか？**

**回答:**

鞍点近似が有効な理由は以下の通りです：

1. **大きな系の極限**: 統計力学では、$N \sim 10^{23}$ という非常に大きな系を扱います。この極限では、被積分関数が極めて鋭いピークを持ち、主要な寄与は極値付近から来ます。

2. **エネルギーの集中**: カノニカル分布では、エネルギーの揺らぎが相対的に小さい（$\sigma_E / \langle E \rangle \sim 1/\sqrt{N}$）ため、被積分関数 $W_N(E)e^{-\beta E}$ が鋭いピークを持ちます。

3. **状態数の急激な増加**: 状態数密度 $W_N(E)$ は、エネルギーに対して急激に増加します（$W_N(E) \propto E^{3N/2}$）。一方、ボルツマン因子 $e^{-\beta E}$ は指数関数的に減少します。この2つの効果が競合し、鋭いピークが形成されます。

**物理的意味**: 鞍点近似は、統計力学における「典型的な状態」の概念と密接に関連しています。大きな系では、系のエネルギーは平均値の周りに極めて集中しており、この集中が鞍点近似の有効性を保証しています。

---

**Q3-2: なぜ被積分関数 $t^x e^{-t}$ のピーク位置が $t = x$ であることが重要なのか？**

**回答:**

ピーク位置 $t = x$ が重要な理由は以下の通りです：

1. **積分への主要な寄与**: 大きな $x$ に対して、積分への主要な寄与は $t \approx x$ の周りから来ます。このため、被積分関数を $t = x$ の周りで展開することで、積分を正確に評価できます。

2. **スケーリング関係**: $t = x$ という関係は、被積分関数のスケーリングを表しています。$x$ が大きくなるにつれて、ピークは比例的に大きくなります。

3. **統計力学との対応**: 統計力学では、系のエネルギーが平均値の周りに集中していることが重要です。同様に、ガンマ関数の積分では、$t = x$ 付近が主要な寄与を与えます。

**物理的意味**: このピーク位置は、統計力学における「最確状態」に対応しています。大きな系では、系は最確状態の周りに極めて集中しており、この集中が統計力学の有効性を保証しています。

---

## II. D次元球の体積

### 問2に関する質問

**Q2-1: なぜ $D$ 次元球の体積が統計力学において重要になるのか？物理的には何を表しているのか？**

**回答:**

$D$ 次元球の体積が重要な理由は以下の通りです：

1. **相空間の体積**: 古典統計力学では、$N$ 個の粒子の運動量空間は $3N$ 次元になります。一定エネルギー面上の状態数を数える際、$3N$ 次元球の体積（または表面積）が必要になります。

2. **状態数密度**: エネルギー $E$ から $E + dE$ の間にある状態数は、$3N$ 次元球の表面積に比例します。これは、状態数密度 $W_N(E)$ の計算に直接関係します。

3. **エントロピーの導出**: ボルツマンの原理 $S = k_B \ln W$ において、$W$ は状態数であり、$D$ 次元球の体積公式から導出されます。

**物理的意味**: $D$ 次元球の体積は、統計力学における「利用可能な状態の数」を表しています。エネルギーが高いほど、より多くの状態が利用可能になり、エントロピーが増加します。

---

**Q2-2: なぜ $D$ 次元球の体積が次元 $D$ に対して非単調（ある次元で最大値を持つ）なのか？これは統計力学にどのような影響を与えるか？**

**回答:**

$D$ 次元球の体積が非単調になる理由は以下の通りです：

1. **ガンマ関数の振る舞い**: 体積公式 $V_D(R) = \frac{\pi^{D/2} R^D}{\Gamma(D/2 + 1)}$ において、$\Gamma(D/2 + 1)$ は $D$ に対して急速に増加します。これにより、$R^D$ の増加が $\Gamma(D/2 + 1)$ の増加に打ち勝つ範囲が限られます。

2. **次元の呪い**: 高次元空間では、体積の大部分が表面付近に集中します。これは「次元の呪い」と呼ばれる現象で、統計力学における状態数の計算に影響を与えます。

**統計力学への影響**: この非単調性は、統計力学における「典型的な状態」の概念と関連しています。高次元空間では、状態の大部分が境界付近に集中し、これは統計力学における「エネルギーの集中」と対応しています。

---

## III. N個の独立な調和振動子

### 問1に関する質問

**Q3-1-1: なぜ分配関数 $Z_N$ からすべての熱力学量を導出できるのか？分配関数の物理的意味は何か？**

**回答:**

分配関数からすべての熱力学量を導出できる理由は以下の通りです：

1. **統計力学の基本関係式**: 分配関数は、系のすべての可能な状態の重み付き和です。この和には、系の統計的性質がすべて含まれています。

2. **熱力学量との対応**: 以下の関係式により、分配関数から熱力学量が導出されます：
   - 自由エネルギー: $F = -k_B T \ln Z_N$
   - 内部エネルギー: $E = -\frac{\partial \ln Z_N}{\partial \beta}$
   - エントロピー: $S = k_B \ln Z_N + \frac{E}{T}$
   - 比熱: $C_V = \frac{\partial E}{\partial T}$

3. **正準集団の完全性**: カノニカル分布（正準集団）は、温度一定の系の統計的性質を完全に記述します。分配関数は、この分布の規格化定数であり、すべての情報を含んでいます。

**物理的意味**: 分配関数は、系の「統計的重みの総和」を表しています。これは、系が取り得るすべての状態の「可能性」を集約した量であり、熱力学量はこの可能性から導出されます。

---

**Q3-1-2: なぜ平均エネルギーが $\langle E \rangle = -\frac{\partial \ln Z_N}{\partial \beta}$ で与えられるのか？この関係式の物理的意味は？**

**回答:**

この関係式が成り立つ理由は以下の通りです：

1. **数学的導出**: 分配関数 $Z_N = \sum_i e^{-\beta E_i}$ を $\beta$ で微分すると：
   $$\frac{\partial Z_N}{\partial \beta} = -\sum_i E_i e^{-\beta E_i}$$
   したがって：
   $$\langle E \rangle = \frac{1}{Z_N}\sum_i E_i e^{-\beta E_i} = -\frac{1}{Z_N}\frac{\partial Z_N}{\partial \beta} = -\frac{\partial \ln Z_N}{\partial \beta}$$

2. **温度との関係**: $\beta = 1/(k_B T)$ であるため、$\beta$ での微分は温度での微分に対応します。これは、内部エネルギーが温度に依存することを反映しています。

**物理的意味**: この関係式は、分配関数の「温度依存性」が内部エネルギーを決定することを示しています。温度が変化すると、各状態の重みが変化し、これが平均エネルギーに反映されます。

---

### 問4に関する質問

**Q3-4-1: なぜ独立な $N$ 個の系の分配関数が $Z_N = (Z_1)^N$ となるのか？この関係式の物理的意味は？**

**回答:**

この関係式が成り立つ理由は以下の通りです：

1. **独立な系の性質**: $N$ 個の系が独立であるとは、各系の状態が互いに影響しないことを意味します。したがって、系全体の状態は、各系の状態の組み合わせとして表されます。

2. **分配関数の因数分解**: 独立な系では、分配関数は各系の分配関数の積になります：
   $$Z_N = \sum_{i_1, i_2, \ldots, i_N} e^{-\beta(E_{i_1} + E_{i_2} + \cdots + E_{i_N})}$$
   $$= \left(\sum_{i_1} e^{-\beta E_{i_1}}\right)\left(\sum_{i_2} e^{-\beta E_{i_2}}\right)\cdots\left(\sum_{i_N} e^{-\beta E_{i_N}}\right) = (Z_1)^N$$

3. **エネルギーの加法性**: 独立な系では、全エネルギーは各系のエネルギーの和です。これにより、ボルツマン因子が因数分解されます。

**物理的意味**: この関係式は、独立な系の統計的性質が各系の統計的性質から導出できることを示しています。これは、統計力学における「独立性」の概念を数学的に表現しています。

---

**Q3-4-2: 独立な系の分配関数が積になることと、エントロピーが和になること（$S_N = N S_1$）の関係は？**

**回答:**

この関係は以下の通りです：

1. **自由エネルギーとの関係**: 自由エネルギーは $F = -k_B T \ln Z$ で与えられるため：
   $$F_N = -k_B T \ln Z_N = -k_B T \ln (Z_1)^N = -N k_B T \ln Z_1 = N F_1$$
   したがって、自由エネルギーは和になります。

2. **エントロピーとの関係**: エントロピーは $S = -\frac{\partial F}{\partial T}$ で与えられるため、自由エネルギーが和であれば、エントロピーも和になります：
   $$S_N = -\frac{\partial F_N}{\partial T} = -\frac{\partial (N F_1)}{\partial T} = N S_1$$

3. **物理的意味**: 独立な系では、各系のエントロピーは独立に加算されます。これは、エントロピーの「広延性」（extensivity）を反映しています。

**物理的意味**: この関係は、統計力学における「広延量」と「強度量」の区別を示しています。エントロピーは広延量であり、系のサイズに比例します。

---

### 問5に関する質問

**Q3-5-1: なぜ状態数 $W_N(M)$ が組合せ論の重複組合せで与えられるのか？この結果の物理的意味は？**

**回答:**

状態数が重複組合せで与えられる理由は以下の通りです：

1. **問題の定式化**: $W_N(M)$ は、$N$ 個の振動子の量子数の和が $M$ になるような状態の数です。これは、「$M$ 個の区別できないボールを $N$ 個の区別できる箱に分配する方法の数」と同じ問題です。

2. **重複組合せの適用**: この問題は、重複組合せ（combination with repetition）を用いて解けます：
   $$W_N(M) = \binom{N+M-1}{M} = \binom{N+M-1}{N-1}$$

3. **物理的意味**: この結果は、同じ全エネルギー $E = \hbar\omega(M + N/2)$ を持つ状態が複数存在することを示しています。これを「縮退」（degeneracy）と呼びます。

**物理的意味**: 状態数の計算は、統計力学における「状態の数え上げ」の基礎です。同じエネルギーを持つ状態が複数存在することは、エントロピーの計算に直接関係します。

---

**Q3-5-2: 縮退度 $W_N(M)$ が $M$ に対してどのように増加するか？これは統計力学にどのような影響を与えるか？**

**回答:**

縮退度の増加について：

1. **$M$ への依存性**: $W_N(M) = \binom{N+M-1}{M}$ は、$M$ に対して多項式的に増加します。具体的には、$M \gg N$ のとき：
   $$W_N(M) \approx \frac{M^{N-1}}{(N-1)!}$$

2. **エントロピーへの影響**: エントロピーは $S = k_B \ln W$ で与えられるため、$W$ が大きいほどエントロピーは大きくなります。したがって、高いエネルギー状態ほど大きなエントロピーを持ちます。

3. **統計力学への影響**: この増加は、統計力学における「状態数の急激な増加」を表しています。これは、高エネルギー状態が実現されやすくなることを意味します。

**物理的意味**: 縮退度の増加は、統計力学における「エントロピーの増加」と対応しています。高いエネルギー状態ほど多くの状態が利用可能であり、これが統計力学の基礎となっています。

---

## IV. 古典理想気体

### 問1に関する質問

**Q4-1-1: なぜ分配関数に $N!$ 因子が必要なのか？この因子の物理的意味は？**

**回答:**

$N!$ 因子が必要な理由は以下の通りです：

1. **粒子の区別不能性**: 量子力学では、同一種の粒子は区別できません。古典統計力学でも、この区別不能性を考慮する必要があります。

2. **位相空間の体積の重複**: $N$ 個の粒子を区別して数えると、同じ物理状態が $N!$ 回重複して数えられます。したがって、正しい状態数を得るには、$N!$ で割る必要があります。

3. **量子統計力学との対応**: 量子統計力学では、ボース統計やフェルミ統計において、粒子の区別不能性が自然に考慮されます。古典統計力学でも、$N!$ 因子により、この対応が保たれます。

**物理的意味**: $N!$ 因子は、統計力学における「粒子の同一性」を反映しています。この因子により、古典統計力学と量子統計力学の整合性が保たれます。

---

**Q4-1-2: なぜ分配関数に $h^{3N}$ 因子が必要なのか？この因子の物理的意味は？**

**回答:**

$h^{3N}$ 因子が必要な理由は以下の通りです：

1. **次元の整合性**: 位相空間の体積要素 $d\Gamma$ は、座標と運動量の積の次元を持ちます。$h$ は「作用」（action）の次元を持ち、プランク定数に相当します。

2. **量子化との対応**: 量子力学では、位相空間の1つの状態が $h$ の体積に対応します。したがって、古典統計力学でも、この量子化を考慮する必要があります。

3. **状態数の正しい数え上げ**: $h^{3N}$ 因子により、位相空間の体積が正しい状態数に変換されます。これにより、エントロピーなどの熱力学量が正しく計算されます。

**物理的意味**: $h^{3N}$ 因子は、統計力学における「量子効果」を反映しています。この因子により、古典統計力学と量子統計力学の対応が保たれます。

---

### 問4に関する質問

**Q4-4-1: なぜ状態数密度 $W_N(E)$ が $E^{(3N-2)/2}$ に比例するのか？この依存性の物理的意味は？**

**回答:**

この依存性が生じる理由は以下の通りです：

1. **相空間の体積**: $3N$ 次元の運動量空間において、エネルギー $E$ 以下の状態数は、$3N$ 次元球の体積に比例します。この体積は $E^{3N/2}$ に比例します。

2. **状態数密度の定義**: 状態数密度 $W_N(E)$ は、エネルギー $E$ から $E + dE$ の間にある状態数です。これは、$3N$ 次元球の表面積に比例し、$E^{(3N-2)/2}$ に比例します。

3. **エネルギーの増加**: エネルギーが増加すると、利用可能な状態数が急激に増加します。これは、エントロピーの増加と対応しています。

**物理的意味**: この依存性は、統計力学における「状態数の急激な増加」を表しています。高いエネルギー状態ほど多くの状態が利用可能であり、これが統計力学の基礎となっています。

---

**Q4-4-2: なぜ状態数密度の指数が $(3N-2)/2$ であり、$3N/2$ ではないのか？**

**回答:**

指数が $(3N-2)/2$ になる理由は以下の通りです：

1. **変数変換の効果**: 変数変換 $p = \sqrt{2mE}$ を行う際、$dp = \sqrt{\frac{m}{2E}} dE$ となります。この $E^{-1/2}$ の因子により、指数が1だけ減少します。

2. **表面積と体積の関係**: $3N$ 次元球の体積は $E^{3N/2}$ に比例しますが、表面積（状態数密度）は $E^{(3N-2)/2}$ に比例します。これは、次元が1つ減るためです。

3. **数学的導出**: 厳密な計算により、$E^{(3N-1)/2} \cdot E^{-1/2} = E^{(3N-2)/2}$ が得られます。

**物理的意味**: この指数の違いは、統計力学における「状態数の数え上げ」の正確さを反映しています。変数変換により、状態数密度が正しく計算されます。

---

### 問5に関する質問

**Q4-5-1: なぜボルツマンの原理 $S = k_B \ln W$ から熱力学的エントロピーが導出できるのか？この原理の物理的意味は？**

**回答:**

ボルツマンの原理が成り立つ理由は以下の通りです：

1. **統計力学と熱力学の対応**: ボルツマンの原理は、統計力学における「状態数」と熱力学における「エントロピー」を結びつけます。これは、統計力学の基礎原理の一つです。

2. **エントロピーの性質**: エントロピーは、系の「無秩序さ」を表します。状態数 $W$ が大きいほど、系はより多くの状態を取ることができ、エントロピーは大きくなります。

3. **対数の選択**: 対数関数は、独立な系のエントロピーが和になるという性質（広延性）を満たします。$S = k_B \ln W$ により、$W = W_1 \cdot W_2$ のとき、$S = S_1 + S_2$ が成り立ちます。

**物理的意味**: ボルツマンの原理は、統計力学における「微視的な状態数」と「巨視的なエントロピー」の関係を表しています。これは、統計力学の最も重要な原理の一つです。

---

**Q4-5-2: なぜ問1と問5で得られた $s_0$ が異なるのか？この違いの物理的意味は？**

**回答:**

$s_0$ が異なる理由は以下の通りです：

1. **近似の違い**: 問1では、スターリングの公式 $\ln N! \approx N\ln N - N$ を用いていますが、問5では、より粗い近似 $\ln\Gamma(x) \approx x\ln x - x$ を用いています。

2. **より正確な近似**: より正確なスターリングの公式 $\ln\Gamma(x) \approx (x-1/2)\ln x - x + \frac{1}{2}\ln(2\pi)$ を用いれば、問1と問5の $s_0$ は一致します。

3. **物理的意味**: この違いは、統計力学における「近似の精度」を反映しています。大きな $N$ に対しては、この違いは無視できますが、小さな $N$ に対しては重要になります。

**物理的意味**: この違いは、統計力学における「近似手法の選択」の重要性を示しています。より正確な近似を用いることで、統計力学と熱力学の整合性が保たれます。

---

### 問6に関する質問

**Q4-6-1: なぜ被積分関数 $W_N(E)e^{-\beta E}$ が鋭いピークを持つのか？このピークの物理的意味は？**

**回答:**

ピークが生じる理由は以下の通りです：

1. **2つの競合する効果**: 状態数密度 $W_N(E)$ は $E^{(3N-2)/2}$ に比例して増加しますが、ボルツマン因子 $e^{-\beta E}$ は指数関数的に減少します。この2つの効果が競合し、鋭いピークが形成されます。

2. **エネルギーの集中**: 大きな $N$ に対して、エネルギーの揺らぎが相対的に小さい（$\sigma_E / \langle E \rangle \sim 1/\sqrt{N}$）ため、被積分関数は平均エネルギーの周りに極めて集中します。

3. **鞍点近似の有効性**: この集中により、鞍点近似が有効になります。主要な寄与はピーク付近から来るため、積分を正確に評価できます。

**物理的意味**: このピークは、統計力学における「典型的な状態」を表しています。大きな系では、系は平均エネルギーの周りに極めて集中しており、この集中が統計力学の有効性を保証しています。

---

**Q4-6-2: なぜピーク位置 $E^*$ が平均エネルギー $\langle E \rangle$ と一致するのか？**

**回答:**

この一致が生じる理由は以下の通りです：

1. **熱力学的関係式**: カノニカル分布では、$\frac{\partial S}{\partial E} = \frac{1}{T}$ が成り立ちます。ピーク位置は、この関係式を満たすエネルギーです。

2. **数学的導出**: 被積分関数の対数の微分が0になる条件から、$E^* = \frac{3N k_B T}{2}$ が得られます。これは、平均エネルギーと一致します。

3. **物理的意味**: この一致は、統計力学における「最確状態」と「平均状態」の一致を表しています。大きな系では、最確状態が平均状態と一致し、これが統計力学の基礎となっています。

**物理的意味**: この一致は、統計力学における「エルゴード性」と関連しています。時間平均とアンサンブル平均が一致することは、統計力学の有効性を保証しています。

---

## まとめ

以上、各小問について、統計力学の本質を理解するための深い質問とその回答を提供しました。これらの質問は、統計力学の基礎概念（分配関数、エントロピー、状態数など）の物理的意味を深く理解するために重要です。

統計力学は、微視的な状態から巨視的な熱力学量を導出する学問であり、これらの質問は、その導出過程の物理的意味を明確にすることを目的としています。

